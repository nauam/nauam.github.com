(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{381:function(e,o,a){"use strict";a.r(o);var s=a(41),r=Object(s.a)({},(function(){var e=this,o=e.$createElement,a=e._self._c||o;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"opcoes-de-job"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#opcoes-de-job"}},[e._v("#")]),e._v(" Opções de "),a("em",[e._v("Job")])]),e._v(" "),a("p",[e._v("O "),a("em",[e._v("Jobs")]),e._v(" pode ser configurado para solicitar a entrada de um usuário, definindo uma ou mais opções nomeadas. Uma opção modela um parâmetro nomeado que pode ser obrigatório ou opcional e inclui uma gama de opções que irão serão apresentado ao usuário quando o "),a("em",[e._v("Job")]),e._v(" for executado.")]),e._v(" "),a("p",[e._v("Os usuários fornecem opções digitando um valor ou selecionando em um menu de opções. Um padrão de validação garante que a entrada está em conformidade com o requisito da opção. Uma vez escolhido, o valor escolhido para a opção fica acessível aos comandos chamados pelo "),a("em",[e._v("Job")]),e._v(".")]),e._v(" "),a("p",[e._v("As escolhas de opções podem ser modeladas como um conjunto estático ou de uma fonte dinâmica. As escolhas estáticas podem ser modeladas como uma lista separada por vírgulas na definição de "),a("em",[e._v("job")]),e._v(". Quando os valores de opção devem ser dinâmicos, o "),a("em",[e._v("Job")]),e._v(" pode ser definido para usar uma URL para recuperar dados de opção de uma fonte externa. Habilitar "),a("em",[e._v("Jobs")]),e._v(" para acessar fontes externas via URL abre a porta para integrar o com outras ferramentas e incorporar seus dados em "),a("em",[e._v("Job")]),e._v(" workflows.")]),e._v(" "),a("h2",{attrs:{id:"solicitando-ao-usuario"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#solicitando-ao-usuario"}},[e._v("#")]),e._v(" Solicitando ao usuário")]),e._v(" "),a("p",[e._v("O efeito óbvio de definir opções de "),a("em",[e._v("Job")]),e._v(" é sua aparência para o usuário executando o "),a("em",[e._v("Job")]),e._v('. Os usuários verão uma página chamada "Escolha Opções de execução..." onde as opções de entrada e de menu devem ser configuradas.')]),e._v(" "),a("p",[e._v("Usuários de linha de comando executando "),a("em",[e._v("Jobs")]),e._v(" via shell "),a("code",[e._v("run")]),e._v("\nferramenta também irá especificar opções como uma string de argumento.")]),e._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[e._v("AVISO")]),e._v(" "),a("p",[e._v("O comando "),a("code",[e._v("run")]),e._v(" não solicita ao usuário as opções necessárias, então você deve especificá-las diretamente.")])]),e._v(" "),a("p",[e._v("Vale a pena gastar um momento para considerar como as opções se tornam parte da interface do usuário para "),a("em",[e._v("Jobs")]),e._v(" e pensar um pouco sobre o próximo nível de formalização do procedimento.")]),e._v(" "),a("ul",[a("li",[e._v("Convenção de nomenclatura e descrição: Visualize como o usuário lerá o nome da opção e julgará sua finalidade a partir da descrição fornecida.")]),e._v(" "),a("li",[e._v("Opções obrigatórias: Tornar uma opção obrigatória significa que o "),a("em",[e._v("Job")]),e._v(" falhará se um usuário não especificar um valor que não seja em branco. Em outras palavras, um valor em branco ou ausente não é permitido para a opção.")]),e._v(" "),a("li",[e._v("Restrições de entrada e validação: Se você precisa fazer com que o valor da opção seja um tanto aberto, considere como você pode criar salvaguardas para controlar sua escolha.")])]),e._v(" "),a("h2",{attrs:{id:"tipos-de-entrada"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tipos-de-entrada"}},[e._v("#")]),e._v(" Tipos de entrada")]),e._v(" "),a("p",[e._v("Tipos de entrada de opção definem como a opção é apresentada na GUI e como ela é usada quando o "),a("em",[e._v("Job")]),e._v(" é executado.")]),e._v(" "),a("p",[e._v("Tipos de entrada:")]),e._v(" "),a("ul",[a("li",[e._v('"Simples"\n'),a("ul",[a("li",[e._v("uma opção normal que é mostrada em texto claro")])])]),e._v(" "),a("li",[e._v('"Seguro"\n'),a("ul",[a("li",[e._v("uma opção segura que é obscurecida no momento da entrada do usuário e cujo valor não é armazenado no banco de dados. Veja "),a("RouterLink",{attrs:{to:"/user-guide/job-options.html#opcoes-de-seguranca"}},[e._v("opções de segurança")]),e._v(".")],1)])]),e._v(" "),a("li",[e._v('"Autenticação remota segura"\n'),a("ul",[a("li",[e._v("uma opção segura que é usada apenas para autenticação remota e não é exposta em scripts ou comandos. Consulte "),a("RouterLink",{attrs:{to:"/user-guide/job-options.html#opcoes-de-autenticacao-remota-segura"}},[e._v("opções de autenticação remota segura")]),e._v(".")],1)])])]),e._v(" "),a("h2",{attrs:{id:"editor-de-opcoes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#editor-de-opcoes"}},[e._v("#")]),e._v(" Editor de opções")]),e._v(" "),a("p",[e._v("As opções podem ser criadas para qualquer "),a("em",[e._v("Job")]),e._v(" armazenado. A página de edição "),a("em",[e._v("Job")]),e._v(" contém uma área que exibe um resumo das opções existentes e um link para adicionar novas ou editar as existentes.")]),e._v(" "),a("p",[a("img",{attrs:{src:"/assets/img/fig0501.png",alt:"Adicionar link de opção"}})]),e._v(" "),a("p",[e._v("O resumo de opções mostra cada opção e seu valor padrão, se os definir.")]),e._v(" "),a("p",[e._v('Clicar no link "editar" abre o editor de opções.')]),e._v(" "),a("p",[a("img",{attrs:{src:"/assets/img/fig0503.png",alt:"Editor de opções"}})]),e._v(" "),a("p",[e._v('O editor de opções exibe um resumo expandido para cada opção definida. Cada opção é listada com seu resumo de uso, descrição, lista de valores e quaisquer restrições. Pressionar o link "Adicionar uma opção" abrirá um formulário para definir um novo parâmetro. Pressionar o link "Fechar" recolherá o editor de opções e retornará à visualização resumida.')]),e._v(" "),a("p",[e._v("Mover o mouse sobre qualquer linha no editor de opções revela links para excluir ou editar a opção destacada. Pressionar o ícone de remoção exibirá um prompt confirmando que você deseja excluir essa opção do "),a("em",[e._v("Job")]),e._v(".")]),e._v(" "),a("p",[e._v('Clicar no link "editar" abre um novo formulário que permite modificar todos os aspectos dessa opção.')]),e._v(" "),a("p",[e._v("As opções também podem ser definidas como parte de uma definição de "),a("em",[e._v("job")]),e._v(" e posteriormente carregadas no servidor . Consulte "),a("RouterLink",{attrs:{to:"/user-guide/document-format-reference/job-v20.html"}},[e._v("job-xml")]),e._v(" e "),a("RouterLink",{attrs:{to:"/user-guide/document-format-reference/job-yaml-v12.html"}},[e._v("job-yaml")]),e._v(" e "),a("RouterLink",{attrs:{to:"/https://google.github.io/cli/commands/#jobs"}},[e._v("rd "),a("em",[e._v("jobs")])]),e._v(" páginas se você preferir usar uma definição textual de "),a("em",[e._v("Job")]),e._v(".")],1),e._v(" "),a("h2",{attrs:{id:"definindo-uma-opcao"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#definindo-uma-opcao"}},[e._v("#")]),e._v(" Definindo uma opção")]),e._v(" "),a("h3",{attrs:{id:"opcoes-de-texto"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#opcoes-de-texto"}},[e._v("#")]),e._v(" Opções de texto")]),e._v(" "),a("p",[e._v('Novas opções podem ser definidas pressionando o link "Adicionar uma opção", enquanto as existentes podem ser alteradas pressionando o link "editar".')]),e._v(" "),a("p",[e._v('Escolha "Texto" no Tipo de Opção:')]),e._v(" "),a("p",[a("img",{attrs:{src:"/assets/img/fig0502.png",alt:"Formulário de edição de opção"}})]),e._v(" "),a("p",[e._v("O formulário de definição de opções é organizado em várias áreas:")]),e._v(" "),a("h3",{attrs:{id:"identificacao"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#identificacao"}},[e._v("#")]),e._v(" Identificação")]),e._v(" "),a("p",[e._v("Aqui você fornece o nome e a descrição da opção. O nome se torna parte dos argumentos aceitáveis para o "),a("em",[e._v("Job")]),e._v(", enquanto a descrição será fornecida como texto de ajuda para os usuários que executam o "),a("em",[e._v("Job")]),e._v(".")]),e._v(" "),a("p",[e._v("O valor padrão será pré-selecionado na GUI quando a opção for apresentada.")]),e._v(" "),a("h3",{attrs:{id:"tipo-de-entrada"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tipo-de-entrada"}},[e._v("#")]),e._v(" Tipo de entrada")]),e._v(" "),a("p",[e._v('Escolha entre "Simples", "Data", "Seguro" e "Autenticação Remota Segura". Para tipos de entrada diferentes de "Simples", a opção de vários valores será desabilitada.')]),e._v(" "),a("h3",{attrs:{id:"formato-de-data"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#formato-de-data"}},[e._v("#")]),e._v(" Formato de data")]),e._v(" "),a("p",[e._v('Se o tipo de entrada "Data" for escolhido, você pode inserir um formato de data a ser usado ao selecionar a data na interface do usuário. Usando o '),a("a",{attrs:{href:"https://momentjs.com/docs/#/displaying/format/",target:"_blank",rel:"noopener noreferrer"}},[e._v("formato momentjs"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("h3",{attrs:{id:"valor-padrao"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#valor-padrao"}},[e._v("#")]),e._v(" Valor padrão")]),e._v(" "),a("p",[e._v("Um valor padrão será definido automaticamente para a opção se não for especificado de outra forma pelo usuário, mesmo se não for especificado entre os argumentos ao executar um "),a("em",[e._v("job")]),e._v(" por meio da linha de comando ou API. Observe que um valor em branco pode ser especificado por meio da linha de comando ou API, que substituirá o uso do valor padrão.")]),e._v(" "),a("h3",{attrs:{id:"valores-permitidos"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#valores-permitidos"}},[e._v("#")]),e._v(" Valores permitidos")]),e._v(" "),a("p",[e._v('Os valores permitidos fornecem um modelo de escolhas possíveis. Isso pode conter uma lista estática de valores ou um URL para um servidor que fornece dados de opção. Os valores podem ser especificados como uma lista separada por vírgulas, conforme visto acima, mas também podem ser solicitados de uma fonte externa usando um "URL remoto".')]),e._v(" "),a("h3",{attrs:{id:"restricoes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#restricoes"}},[e._v("#")]),e._v(" Restrições")]),e._v(" "),a("p",[e._v('Define os critérios sobre os quais a entrada deve ser aceita ou apresentada. As escolhas de opções podem ser controladas usando a restrição "Enforced from values". Quando definido como "true", o apresentará apenas um menu pop-up. Se definido como "false", um campo de texto também será apresentado. Insira uma expressão regular no campo "Match Regular Expression" que o '),a("em",[e._v("Job")]),e._v(" avaliará quando executado.")]),e._v(" "),a("h3",{attrs:{id:"requerimento"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#requerimento"}},[e._v("#")]),e._v(" Requerimento")]),e._v(" "),a("p",[e._v("Indica se o "),a("em",[e._v("Job")]),e._v(' só pode ser executado se um valor valido for fornecido para essa opção. Escolha "Não" para indicar que um valor em branco é permitido e escolha "Sim" para indicar que um valor em branco não é permitido.')]),e._v(" "),a("p",[e._v("Se um valor padrão for definido, ele será usado quando nenhum valor for fornecido, a menos que um valor em branco seja permitido e seja explicitamente especificado.")]),e._v(" "),a("p",[a("img",{attrs:{src:"/assets/img/fig-option-multival.png",alt:"Formulário de opção de valor múltiplo"}})]),e._v(" "),a("h3",{attrs:{id:"multi-valor"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#multi-valor"}},[e._v("#")]),e._v(" Multi-valor")]),e._v(" "),a("p",[e._v('Define se a entrada do usuário pode consistir em vários valores. Escolher "Não" indica que apenas um único valor pode ser escolhido como entrada. Escolher "Sim" indica que o usuário pode selecionar vários valores de entrada dos valores permitidos e/ou inserir vários valores próprios.')]),e._v(" "),a("h3",{attrs:{id:"delimitador"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#delimitador"}},[e._v("#")]),e._v(" Delimitador")]),e._v(" "),a("p",[e._v("A string delimitadora será usada para separar os vários valores quando o "),a("em",[e._v("Job")]),e._v(" for executado.")]),e._v(" "),a("h3",{attrs:{id:"selecionar-todos-os-valores-por-padrao"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#selecionar-todos-os-valores-por-padrao"}},[e._v("#")]),e._v(" Selecionar todos os valores por padrão")]),e._v(" "),a("p",[e._v("Se marcada, e nenhum valor padrão é especificado, todos os valores remotos ou locais serão selecionados por padrão.")]),e._v(" "),a("p",[e._v('Quando estiver satisfeito com a definição da opção, pressione o botão "Salvar" para adicioná-la à definição '),a("em",[e._v("Job")]),e._v('. Pressionar o botão "Cancelar" descartará as alterações e fechará o formulário.')]),e._v(" "),a("p",[e._v("Uso (veja abaixo)")]),e._v(" "),a("p",[a("img",{attrs:{src:"/assets/img/fig-option-usage.png",alt:"Uso da opção"}})]),e._v(" "),a("h3",{attrs:{id:"variavel-de-carimbo-de-data-hora-da-opcao"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#variavel-de-carimbo-de-data-hora-da-opcao"}},[e._v("#")]),e._v(" Variável de carimbo de data/hora da opção")]),e._v(" "),a("p",[e._v("Você pode usar a string "),a("code",[e._v("${DATE:format}")]),e._v(" como um valor de opção do "),a("em",[e._v("job")]),e._v(" (tanto como valor padrão ou como entrada pelo usuário), que será convertido quando o "),a("em",[e._v("job")]),e._v("/comando for executado. Esta variável também permite adicionar ou remover dias como você pode ver abaixo.")]),e._v(" "),a("p",[a("code",[e._v("${DATE:format}")]),e._v(" data atual no formato usado pelo Java "),a("a",{attrs:{href:"https://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("SimpleDateFormatter"),a("OutboundLink")],1)]),e._v(" "),a("p",[a("code",[e._v("${DATE+2:format}")]),e._v(" daqui a dois dias")]),e._v(" "),a("p",[a("code",[e._v("${DATE-2:format}")]),e._v(" dois dias atrás")]),e._v(" "),a("h3",{attrs:{id:"tipo-de-opcao-de-arquivo"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tipo-de-opcao-de-arquivo"}},[e._v("#")]),e._v(" Tipo de opção de arquivo")]),e._v(" "),a("p",[e._v('Escolha "Arquivo" no Tipo de Opção:')]),e._v(" "),a("p",[a("img",{attrs:{src:"/assets/img/fig-newoption-file.png",alt:"Formulário de edição de opção de arquivo"}})]),e._v(" "),a("p",[e._v("O nome e a descrição da opção podem ser inseridos.")]),e._v(" "),a("p",[e._v("Obrigatório")]),e._v(" "),a("p",[e._v(": Escolha se deseja que a opção tenha um valor.")]),e._v(" "),a("p",[e._v("Uso da opção de arquivo:")]),e._v(" "),a("p",[e._v("A variável "),a("code",[e._v("option.NAME")]),e._v(" conterá um ID único que identifica o arquivo enviado.")]),e._v(" "),a("p",[a("code",[e._v("file.NAME")]),e._v(" será o caminho do arquivo local.")]),e._v(" "),a("p",[a("code",[e._v("file.NAME.filename")]),e._v(" será o nome do arquivo original (se disponível).")]),e._v(" "),a("p",[a("code",[e._v("file.NAME.sha")]),e._v(" será o hash SHA256 do arquivo.")]),e._v(" "),a("h2",{attrs:{id:"uso-do-script"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#uso-do-script"}},[e._v("#")]),e._v(" Uso do script")]),e._v(" "),a("p",[e._v("Os valores das opções podem ser passados para scripts como um argumento ou referenciados dentro do script por meio de um token nomeado. Cada valor de opção é definido nas variáveis de contexto de Opções como "),a("code",[e._v("option.NAME")]),e._v(".")]),e._v(" "),a("p",[e._v("Consulte a seção [Variáveis ​​de contexto](/user-guide/job-workflows.md # context-variables).")]),e._v(" "),a("p",[a("strong",[e._v("Exemplo:")])]),e._v(" "),a("p",[e._v("Um "),a("em",[e._v("Job")]),e._v(' chamado "hello", tem uma opção chamada "message".')]),e._v(" "),a("p",[e._v('A assinatura da opção "hello" '),a("em",[e._v("Job")]),e._v(" seria: "),a("code",[e._v("-message <>")]),e._v(".")]),e._v(" "),a("p",[a("img",{attrs:{src:"/assets/img/fig0504.png",alt:"Uso da opção"}})]),e._v(" "),a("p",[e._v("Os argumentos passados ​​para o script são definidos como "),a("code",[e._v("${option.message}")]),e._v(".")]),e._v(" "),a("p",[e._v('Aqui está o conteúdo deste script simples que mostra os vários\nformulários para acessar o valor da opção "message".')]),e._v(" "),a("div",{staticClass:"language-bash .numberLines extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[e._v("#!/bin/sh")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("envvar")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$RDoptionMESSAGE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#mensagem de acesso como variável de ambiente.echo args = $ 1; # valor lido passado para o vetor de argumento")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" message "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" @ option.message @"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# mensagem de acesso via sintaxe de token de substituição")]),e._v("\n")])])]),a("p",[e._v("Quando o usuário executa o "),a("em",[e._v("job")]),e._v(' "hello", será solicitado o\nvalor da "mensagem".')]),e._v(" "),a("p",[a("img",{attrs:{src:"/assets/img/fig0505.png",alt:"Opção inserida"}})]),e._v(" "),a("p",[e._v('Vamos supor que eles escolheram a palavra "howdy" em resposta. A saída do '),a("em",[e._v("Job")]),e._v(" será:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("envar "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" howdy\nargs "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" howdy\nmensagem "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" howdy\n")])])]),a("p",[e._v("Se você definir a opção como "),a("em",[e._v("Required")]),e._v(", o "),a("em",[e._v("Job")]),e._v(" não será executado, a menos que o usuário forneça um valor que não esteja em branco.")]),e._v(" "),a("p",[e._v("Se você definir a opção como não "),a("em",[e._v("Required")]),e._v(", o valor da opção poderá ficar em branco e especificar um valor em branco resultará em:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("envar "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("\nargs "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("\nmensagem "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("\n")])])]),a("p",[e._v("Você pode usar o "),a("em",[e._v("Valor Padrão")]),e._v(" de uma opção para fornecer um valor caso o usuário não o especifique. Na GUI, o "),a("em",[e._v("Valor Padrão")]),e._v(" será automaticamente apresentado na página Execução de "),a("em",[e._v("Job")]),e._v(". Na CLI ou API, deixando de fora um argumento "),a("code",[e._v("-option")]),e._v(" para um "),a("em",[e._v("job")]),e._v(" usar o valor padrão.")]),e._v(" "),a("p",[e._v("Você também pode manipular valores padrão em um script, se sua opção não especificar um ou se o usuário especificar um valor em branco para a opção:")]),e._v(" "),a("p",[a("strong",[e._v("Variável de ambiente:")])]),e._v(" "),a("p",[e._v("Como precaução, você pode testar a existência da variável e talvez definir um valor padrão. Para testar sua existência, você pode usar:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("teste -s "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"$ RDoptionNAME"')]),e._v("\n")])])]),a("p",[e._v("Você também pode usar um recurso Bash que testa e padroniza para um valor:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("${RDoptionNAME"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":=")]),e._v("mydefault}")]),e._v("\n")])])]),a("p",[a("strong",[e._v("Token de substituição:")])]),e._v(" "),a("p",[e._v("Se a opção estiver em branco ou não configurada, o token será substituído por uma string em branco. Você pode escrever seu script de forma um pouco mais defensiva e alterar a implementação da seguinte forma:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("mensagem "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"@ opção.mensagem @"')]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("if")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("-z "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"$ message"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\nentão\nmensagem "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" mydefault\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("fi")]),e._v("\n")])])]),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[e._v("AVISO")]),e._v(" "),a("p",[e._v("A sintaxe do token de substituição só é suportada em passos de script embutido (ou seja, não em arquivo de script ou passos de comando).")])]),e._v(" "),a("p",[a("strong",[e._v("Token de substituição de escape:")])]),e._v(" "),a("p",[e._v("Se você quiser usar o caractere "),a("code",[e._v("@")]),e._v(" de uma forma que pareça um token de substituição, você pode escapar dele usando "),a("code",[e._v("@@")]),e._v(", ou seja, dobrando-o.")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# escape do sinal @ para evitar expansão antes de @ option.domain @")]),e._v("\nemail "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"usuário@@mail.@option.domain@"')]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Se o primeiro sinal @ vier imediatamente antes do token, use três @")]),e._v("\nemail "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"usuário@@@opção.domínio@"')]),e._v("\n")])])]),a("p",[e._v("Neste exemplo, o "),a("code",[e._v("@@@option.domain@")]),e._v(" resultará em "),a("code",[e._v("@mydomain")]),e._v(",\ne "),a("code",[e._v("@@mail.@option.domain2@")]),e._v(" resultará em "),a("code",[e._v("@mail.mydomain")]),e._v(".")]),e._v(" "),a("p",[e._v("Se você não escapar do "),a("code",[e._v("@")]),e._v(" no segundo exemplo, então "),a("code",[e._v("@mail.@")]),e._v("\nserá expandido para um valor ausente, resultando em uma string em branco.")]),e._v(" "),a("p",[e._v("Se você não escapar de "),a("code",[e._v("@")]),e._v(" no segundo exemplo, então "),a("code",[e._v("@mail.@")]),e._v(" Será expandido para um valor ausente, resultando em uma string em branco.")]),e._v(" "),a("p",[e._v("Você não precisa escapar do sinal "),a("code",[e._v("@")]),e._v(" em todos os casos, apenas quando pode parecer um token de expansão. Se houver qualquer caractere de espaço em branco antes do próximo sinal "),a("code",[e._v("@")]),e._v(", ele não precisa ser escapado:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# primeiro sinal @ não precisa de escape")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("text")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Hi user@somewhere, @option.greeting@!"')]),e._v("\n")])])]),a("h2",{attrs:{id:"valores-de-escape"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#valores-de-escape"}},[e._v("#")]),e._v(" Valores de escape")]),e._v(" "),a("p",[e._v("Quando os argumentos para o script ou o conteúdo de uma string de execução de Comando são\navaliadas, referências de propriedades embutidas como "),a("code",[e._v("${option.name}")]),e._v(" são substituídas por\nos valores inseridos por um usuário.")]),e._v(" "),a("p",[e._v("Para evitar que qualquer entrada do usuário inclua caracteres especiais do shell (acidentalmente ou maliciosamente), qualquer argumento que tenha referências incorporadas será colocado entre aspas para o shell.")]),e._v(" "),a("p",[e._v("Você também deve ter cuidado em como os argumentos para scripts são usados ​​em um script.")]),e._v(" "),a("p",[e._v("Por exemplo, se você tiver um passo de script com string de argumento "),a("code",[e._v("${option.message}")]),e._v(", e script:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[e._v("#!/bin/bash")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$1")]),e._v("\n")])])]),a("p",[e._v("Então este script irá expandir parcialmente o valor "),a("code",[e._v("${option.message}")]),e._v(" uma segunda vez, mesmo que tenha sido citado corretamente para passar para seu script.")]),e._v(" "),a("p",[e._v("Em vez disso, você deve fazer algo assim:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[e._v("#!/bin/bash")]),e._v("\neco "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$1")]),e._v('"')]),e._v("\n")])])]),a("p",[e._v("O que permite que o shell trate corretamente o valor de entrada citando-o.")]),e._v(" "),a("h3",{attrs:{id:"usando-valores-sem-escape"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#usando-valores-sem-escape"}},[e._v("#")]),e._v(" Usando valores sem escape")]),e._v(" "),a("p",[e._v("Se o "),a("em",[e._v("job")]),e._v(" precisa fornecer uma opção em sua forma bruta, sem escape, é possível usar a chave de pesquisa de contexto "),a("code",[e._v("unquotedoption")]),e._v(" ao invés de "),a("code",[e._v("option")]),e._v(".")]),e._v(" "),a("p",[e._v("Por exemplo:\nO valor da opção "),a("code",[e._v("${option.name}")]),e._v(" pode ser acessado sem nenhum escape referenciando-o como "),a("code",[e._v("${unquotedoption.name}")]),e._v(".\nEm um script similarmente use "),a("code",[e._v("@unquotedoption.name@")]),e._v(" ao invés de "),a("code",[e._v("@option.name@")]),e._v(".")]),e._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[e._v("AVISO")]),e._v(" "),a("p",[e._v("O uso de valores não escapados pode expor o ambiente a riscos de segurança, como injeção de comando (mas não se limitando à injeção de comando!).")])]),e._v(" "),a("blockquote",[a("p",[e._v("Considere o exemplo a seguir, onde um usuário tem permissão para fornecer uma lista de diretórios para um "),a("em",[e._v("job")]),e._v(" de backup hipotético. Vamos supor também que "),a("em",[e._v("job")]),e._v(" processou a lista de diretórios com "),a("code",[e._v("tar -zcvf /tmp/archive.tgz @unquotedoption.targetdirs@")]),e._v(". Então, um usuário mal-intencionado pode enganar o "),a("em",[e._v("job")]),e._v(" para que ele execute um comando extra fornecendo este valor:\n"),a("code",[e._v("targetdirs")]),e._v(":"),a("code",[e._v("/etc/home/var/lib/redis; rm -rf/")]),e._v(".")])]),e._v(" "),a("p",[e._v("Então, dependendo dos privilégios do usuário, o script felizmente destruirá tantos diretórios e arquivos quanto puder no nó alvo. Você pode limitar o risco adotando máscaras regex apropriadas, codificando o script de forma defensiva e usando o princípio de privilégio mínimo.")]),e._v(" "),a("h2",{attrs:{id:"opcoes-de-seguranca"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#opcoes-de-seguranca"}},[e._v("#")]),e._v(" Opções de segurança")]),e._v(" "),a("p",[e._v("As opções podem ser marcadas como Seguras, para mostrar um prompt de senha na GUI, em vez de um campo de texto normal ou menu suspenso. Os valores das opções seguras não são armazenados com o Execution, assim como os outros valores das opções.")]),e._v(" "),a("p",[e._v("Existem dois tipos de opções seguras:")]),e._v(" "),a("ul",[a("li",[e._v("Seguro\n"),a("ul",[a("li",[e._v("esses valores de opção são expostos em scripts e comandos.")])])]),e._v(" "),a("li",[e._v("Autenticação remota segura\n"),a("ul",[a("li",[e._v("esses valores de opção "),a("strong",[e._v("não")]),e._v(" são expostos em scripts e comandos e são usados apenas por "),a("em",[e._v("Nó")]),e._v(" Executores para autenticar em "),a("em",[e._v("Nós")]),e._v(" e executar comandos.")])])])]),e._v(" "),a("p",[e._v("As opções seguras não suportam entrada de vários valores.")]),e._v(" "),a("p",[e._v("As opções seguras não podem ser usadas como entrada de autenticação para executores do "),a("em",[e._v("Nó")]),e._v(", você deve usar uma opção de autenticação remota segura descrita abaixo.")]),e._v(" "),a("h3",{attrs:{id:"nota-importante"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nota-importante"}},[e._v("#")]),e._v(" Nota importante")]),e._v(" "),a("p",[e._v('Os valores da opção "segura" não são armazenados no banco de dados do quando o '),a("em",[e._v("Job")]),e._v(" é executado, mas o valor inserido\né exposto para uso em scripts e comandos. Certifique-se de reconhecer essas implicações de segurança antes de usá-los. As opções seguras estão disponíveis para uso em scripts e comandos como qualquer outro valor de opção:")]),e._v(" "),a("ul",[a("li",[e._v("como argumentos de texto simples usando "),a("code",[e._v("${option.name}")]),e._v(" "),a("ul",[a("li",[e._v("Usar o valor da opção como um argumento para um comando pode expor o valor do texto simples na tabela de processo do sistema")])])]),e._v(" "),a("li",[e._v("como variáveis de ambiente de texto simples na execução remota e local de script como "),a("code",[e._v("$RDoptionNAME")]),e._v(" "),a("ul",[a("li",[e._v("Scripts locais e possivelmente remotos podem receber este valor em seu ambiente")])])]),e._v(" "),a("li",[e._v("como tokens de texto simples expandidos em scripts remotos como "),a("code",[e._v("@option.name@")]),e._v(".\n"),a("ul",[a("li",[e._v("Os passos do fluxo de "),a("em",[e._v("Job")]),e._v(" de script embutido que contêm uma expansão de token serão expandidas em um arquivo temporário e o arquivo temporário conterá o valor da opção de texto simples.")])])])]),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("DICA")]),e._v(" "),a("p",[e._v("Quando passados ​​como argumentos para "),a("em",[e._v("Job")]),e._v(" References, eles só podem ser passados ​​como o valor de outra opção Secure. Consulte "),a("RouterLink",{attrs:{to:"/user-guide/job-options.html#usando-opcoes-seguras-com-referencias-job"}},[e._v("Usando opções seguras com referências de "),a("em",[e._v("Job")])]),e._v(".")],1)]),e._v(" "),a("h3",{attrs:{id:"opcoes-de-autenticacao-remota-segura"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#opcoes-de-autenticacao-remota-segura"}},[e._v("#")]),e._v(" Opções de autenticação remota segura")]),e._v(" "),a("p",[e._v("O "),a("RouterLink",{attrs:{to:"/Administration/projects/node-execution/ssh.html"}},[e._v("provedor SSH")]),e._v(" integrado para execução de nó permite o uso de senhas para mecanismos de autenticação SSH e/ou Sudo, e as senhas são fornecidas por Opções de autenticação remota segura definidas em um "),a("em",[e._v("Job")]),e._v(".")],1),e._v(" "),a("p",[e._v("As opções de autenticação remota segura têm algumas limitações em comparação com as opções simples e seguras:")]),e._v(" "),a("ul",[a("li",[e._v("Os valores inseridos pelo usuário não estão disponíveis para script normal e expansão de valor de opção de comando. Isso significa que eles só podem ser usados para fins de autenticação remota.")])]),e._v(" "),a("h3",{attrs:{id:"usando-opcoes-seguras-com-referencias-job"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#usando-opcoes-seguras-com-referencias-job"}},[e._v("#")]),e._v(" Usando opções seguras com referências "),a("em",[e._v("Job")])]),e._v(" "),a("p",[e._v("Ao definir um "),a("RouterLink",{attrs:{to:"/user-guide/node-steps/builtin.html#passo-de-referencia-de-job"}},[e._v("passo de Referência de "),a("em",[e._v("Job")]),e._v(" em um fluxo de trabalho")]),e._v(", você pode especificar os argumentos que são transmitidos a ela. Você pode passar os valores da Opção segura e da Opção de autenticação remota segura de um "),a("em",[e._v("job")]),e._v(" de nível superior para uma Referência de "),a("em",[e._v("job")]),e._v(", mas os valores de opção "),a("em",[e._v("não podem ser passados para outra opção de um tipo diferente")]),e._v(". Portanto, um "),a("em",[e._v("job")]),e._v(" pai só pode passar valores de opção para a referência de "),a("em",[e._v("job")]),e._v(" se o tipo de opção for o mesmo entre os "),a("em",[e._v("jobs")]),e._v(".")],1),e._v(" "),a("p",[e._v("Essa restrição é para manter o projeto de segurança dessas opções:")]),e._v(" "),a("ol",[a("li",[e._v("As opções seguras não devem ser armazenadas no banco de dados de execução do , portanto, não devem ser usadas como valores de opção simples.")]),e._v(" "),a("li",[e._v("As opções de autenticação remota segura não devem ser usadas em scripts/comandos, portanto, não devem ser usadas como valores de opção segura ou simples.")])]),e._v(" "),a("p",[e._v("Como exemplo, aqui estão dois "),a("em",[e._v("jobs")]),e._v(", "),a("em",[e._v("Job")]),e._v(" A e "),a("em",[e._v("Job")]),e._v(" B, que definem algumas opções:")]),e._v(" "),a("ul",[a("li",[a("em",[e._v("Job")]),e._v(" A\n"),a("ul",[a("li",[e._v('Opção "plain1" - Simples')]),e._v(" "),a("li",[e._v('Opção "seguro1" - Seguro')]),e._v(" "),a("li",[e._v('Opção "auth1" - Autenticação remota segura')])])]),e._v(" "),a("li",[a("em",[e._v("Job")]),e._v(" B\n"),a("ul",[a("li",[e._v('Opção "plain2" - Simples')]),e._v(" "),a("li",[e._v('Opção "seguro2" - Seguro')]),e._v(" "),a("li",[e._v('Opção "auth2" - Autenticação remota segura')])])])]),e._v(" "),a("p",[e._v("Se "),a("em",[e._v("Job")]),e._v(" A define uma referência de "),a("em",[e._v("Job")]),e._v(" para chamar "),a("em",[e._v("Job")]),e._v(" B, então o único mapeamento válido é mostrado abaixo:")]),e._v(" "),a("ul",[a("li",[e._v("plain1 -> plain2")]),e._v(" "),a("li",[e._v("secure1 -> secure2")]),e._v(" "),a("li",[e._v("auth1 -> auth2")])]),e._v(" "),a("p",[e._v("Portanto, os argumentos para a Referência de "),a("em",[e._v("Job")]),e._v(" podem ter a seguinte aparência:")]),e._v(" "),a("ul",[a("li",[e._v("plain2 ${option.plain1}")]),e._v(" "),a("li",[e._v("secure2 ${option.secure1}")]),e._v(" "),a("li",[e._v("auth2 ${option.auth1}")])]),e._v(" "),a("blockquote",[a("p",[e._v("Observação: se você definir argumentos de maneira incorreta, as opções de autenticação remota segura e segura não serão definidas quando a referência de "),a("em",[e._v("job")]),e._v(" forem ligadas. As opções simples se comportarão da maneira como se comportam em argumentos de comando ou script e serão deixadas como estão, como referências de propriedade não interpretadas.")])]),e._v(" "),a("h3",{attrs:{id:"opcoes-seguras-usando-armazenamento-de-chaves"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#opcoes-seguras-usando-armazenamento-de-chaves"}},[e._v("#")]),e._v(" Opções seguras usando armazenamento de chaves")]),e._v(" "),a("p",[e._v("As opções seguras podem especificar um caminho de armazenamento em vez de um valor padrão. Este caminho para o "),a("RouterLink",{attrs:{to:"/Administration/security/key-storage.html"}},[e._v("Key Storage Facility")]),e._v(" será carregado como o valor da opção quando um não for fornecido.")],1),e._v(" "),a("p",[e._v("O caminho deve indicar uma entrada de "),a("code",[e._v("password")]),e._v(" armazenada na instalação de armazenamento.")]),e._v(" "),a("p",[a("img",{attrs:{src:"/assets/img/jobs-options-secure-storage-path.png",alt:"Caminho de armazenamento para opção segura"}})]),e._v(" "),a("h2",{attrs:{id:"valores-de-opcao-remota"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#valores-de-opcao-remota"}},[e._v("#")]),e._v(" Valores de opção remota")]),e._v(" "),a("p",[e._v("Um modelo de valores de opção pode ser recuperado de uma fonte externa chamada de "),a("em",[e._v("provedor de modelo de opção")]),e._v(". Quando "),a("code",[e._v("valuesUrl")]),e._v(" é especificado para uma opção, o modelo de valores permitidos é recuperado do URL especificado.")]),e._v(" "),a("p",[e._v("Isso é útil em alguns cenários quando o google é usado para coordenar processos que dependem de outros sistemas:")]),e._v(" "),a("ul",[a("li",[e._v("Implantar pacotes ou artefatos produzidos por um servidor de construção ou CI, por exemplo, Jenkins.\n"),a("ul",[a("li",[e._v("Uma lista de artefatos de construção recentes do Jenkins pode ser importada como dados de opções, para que um usuário possa escolher um nome de pacote apropriado para implantar em uma lista.")])])]),e._v(" "),a("li",[e._v("Seleção de um conjunto de ambientes disponíveis, definidos em um CMDB")]),e._v(" "),a("li",[e._v("Qualquer situação na qual variáveis de entrada para seus "),a("em",[e._v("Jobs")]),e._v(" devem ser selecionadas a partir de algum conjunto de valores produzidos por um sistema diferente.")])]),e._v(" "),a("h2",{attrs:{id:"fornecedor-de-modelo-de-opcao"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fornecedor-de-modelo-de-opcao"}},[e._v("#")]),e._v(" Fornecedor de modelo de opção")]),e._v(" "),a("p",[e._v("O provedor de modelo de opção é um mecanismo que permite que as opções definidas para um "),a("em",[e._v("Job")]),e._v(" tenham alguns dos valores de entrada possíveis fornecidos por um serviço remoto ou banco de dados.")]),e._v(" "),a("p",[e._v("Os provedores de modelo de opção são configurados por opção (onde um "),a("em",[e._v("Job")]),e._v(" pode ter zero ou mais opções).")]),e._v(" "),a("h3",{attrs:{id:"requisitos"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#requisitos"}},[e._v("#")]),e._v(" Requisitos")]),e._v(" "),a("ol",[a("li",[e._v("Os dados do modelo de opções devem ser "),a("a",{attrs:{href:"http://www.json.org",target:"_blank",rel:"noopener noreferrer"}},[e._v("formatados em JSON"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("li",[e._v("Deve estar acessível via HTTP(S) ou no disco local para o servidor do .")]),e._v(" "),a("li",[e._v("Deve estar em uma das duas estruturas JSON, "),a("em",[e._v("todos")]),e._v(":\n"),a("ul",[a("li",[e._v("Uma matriz de valores de string")]),e._v(" "),a("li",[e._v("OU, uma matriz de mapas, cada um com duas entradas, "),a("code",[e._v("name")]),e._v(" e "),a("code",[e._v("value")]),e._v(".")])])]),e._v(" "),a("li",[e._v("Por padrão, a resposta HTTP(S) deve incluir o tipo de conteúdo "),a("code",[e._v("application/json")]),e._v(" no cabeçalho.\nCaso isso não possa ser controlado, o atributo "),a("code",[e._v("project.jobs.disableRemoteOptionJsonCheck")]),e._v(" pode ser definido como "),a("code",[e._v("true")]),e._v(" nas configurações do projeto.")])]),e._v(" "),a("h3",{attrs:{id:"configuracao"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configuracao"}},[e._v("#")]),e._v(" Configuração")]),e._v(" "),a("p",[e._v("Cada entrada de opção para um "),a("em",[e._v("Job")]),e._v(" pode ser configurada para obter o conjunto de valores possíveis de um URL remoto. Se você está criando jobs por meio do "),a("RouterLink",{attrs:{to:"/user-guide/document-format-reference/job-v20.html#opcao"}},[e._v("formato de arquivo job.xml")]),e._v(", simplesmente adicione um atributo "),a("code",[e._v("valuesUrl")]),e._v(" para a"),a("code",[e._v("<option>")]),e._v(". Se você estiver modificando o "),a("em",[e._v("Job")]),e._v(' na interface web do , poderá inserir um URL no campo "URL remoto" para a opção.\npor exemplo:')],1),e._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),e._v("option")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[e._v("valuesUrl")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v('"')]),e._v("http://site.example.com/values.json"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v('"')])]),e._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[e._v("...")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("/>")])]),e._v("\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("DICA")]),e._v(" "),a("p",[e._v("O esquema de URL do arquivo também é aceitável (por exemplo, "),a("code",[e._v("file:/path/to/job/options/optA.json")]),e._v(").")])]),e._v(" "),a("p",[e._v("Os dados do valor devem ser retornados no formato de dados JSON descrito abaixo.")]),e._v(" "),a("h3",{attrs:{id:"formato-json"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#formato-json"}},[e._v("#")]),e._v(" formato JSON")]),e._v(" "),a("p",[e._v("Três estilos de dados de retorno são suportados: lista simples, objeto simples e uma lista de nome/valor. Para uma lista simples, os valores da lista serão exibidos em uma lista pop-up ao executar o "),a("em",[e._v("Job")]),e._v(". Se um objeto simples ou pares nome/valor forem retornados, então o "),a("code",[e._v("name")]),e._v(" será exibido na lista, mas o "),a("code",[e._v("value")]),e._v(" será usado como a entrada.")]),e._v(" "),a("h3",{attrs:{id:"exemplos"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#exemplos"}},[e._v("#")]),e._v(" Exemplos")]),e._v(" "),a("p",[e._v("Lista Simples:")]),e._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"valor x para teste"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"valor y para teste"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n")])])]),a("p",[e._v("Isso irá preencher o menu de seleção com os valores fornecidos.")]),e._v(" "),a("p",[e._v("Objeto simples:")]),e._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"Name1"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"value1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"Name2"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"value2"')]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),a("p",[e._v("Isso irá preencher o menu de seleção para mostrar os nomes e usar os valores.")]),e._v(" "),a("p",[e._v("Lista de valores de nomes:")]),e._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"X Label"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"value"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"x value"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Y Label"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"value"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"y value"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"A Label"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"value"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"a value"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n")])])]),a("p",[e._v("Para opções com vários valores, se o resultado for uma lista de objetos e alguns tiverem uma propriedade "),a("code",[e._v("selected")]),e._v(" de "),a("code",[e._v("true")]),e._v(", esses valores serão selecionados por padrão.")]),e._v(" "),a("p",[e._v("Para uma opção de valor único, o primeiro resultado com "),a("code",[e._v("selected=true")]),e._v(" será selecionado (se houver).")]),e._v(" "),a("p",[e._v("Lista de valores de nomes com seleções padrão:")]),e._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"X Label"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"value"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"x value"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"selected"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Y Label"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"value"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"y value"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"A Label"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"value"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"a value"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"selected"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n")])])]),a("h3",{attrs:{id:"parametros-de-conexao-de-url"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#parametros-de-conexao-de-url"}},[e._v("#")]),e._v(" Parâmetros de conexão de URL")]),e._v(" "),a("p",[e._v("Você pode configurar tempos limites globalmente conforme descrito em "),a("RouterLink",{attrs:{to:"/administration/configuration/config-file-reference.html#config.properties"}},[e._v("Configuração - Parâmetros de conexão da URL da opção remota do "),a("em",[e._v("Job")])]),e._v(".")],1),e._v(" "),a("p",[e._v("Você também pode especificar esses parâmetros de conexão por URL:")]),e._v(" "),a("p",[a("code",[e._v("timeout")]),e._v("\n: tempo limite do soquete em segundos")]),e._v(" "),a("p",[a("code",[e._v("contimeout")]),e._v("\n: tempo limite de conexão em segundos")]),e._v(" "),a("p",[a("code",[e._v("retry")]),e._v("\n: repetir a contagem se não houver resposta do servidor")]),e._v(" "),a("p",[e._v('Para definir isso em uma URL remota de Option, adicione-os como a parte "fragmento" da URL, após o caractere '),a("code",[e._v("#")]),e._v(" como:")]),e._v(" "),a("div",{staticClass:"language-http extra-class"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("http:")]),e._v("//host/mypath#timeout=60;contimeout=5;retry=1\n")])])]),a("p",[e._v("Use "),a("code",[e._v("key=value")]),e._v(" para um parâmetro e separe vários parâmetros com o caractere"),a("code",[e._v(";")]),e._v(".")]),e._v(" "),a("h3",{attrs:{id:"opcoes-remotas-em-cascata"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#opcoes-remotas-em-cascata"}},[e._v("#")]),e._v(" Opções remotas em cascata")]),e._v(" "),a("p",[e._v("As opções em cascata permitem que o URL de valores remotos de uma opção incorpore os valores inseridos pelo usuário para outras opções ao executar um "),a("em",[e._v("Job")]),e._v(". Quando o usuário insere ou seleciona um valor para uma das outras opções, o JSON remoto é atualizado para a opção atual.")]),e._v(" "),a("p",[e._v("Isso fornece um mecanismo para declarar conjuntos hierárquicos ou dependentes de valores de opção.")]),e._v(" "),a("p",[e._v('Por exemplo. se você quiser uma opção para escolher um "repositório" e outra opção para selecionar um "ramo" específico dentro desse repositório. Defina seu provedor de opções para responder corretamente com base no valor de "repositório" selecionado e defina sua URL de opção remota para incluir uma referência ao valor de opção de "repositório". A GUI do irá então recarregar os valores JSON da URL remota e inserir o valor correto da opção "repositório" ao carregar os valores da opção "branch". Se o usuário alterar o repositório selecionado, os valores do branch serão atualizados automaticamente.')]),e._v(" "),a("p",[e._v("Você pode declarar a dependência de uma opção para outra incorporando referências de propriedade na URL de valores remotos. A referência da propriedade tem o formato "),a("code",[e._v("${option.[name].value}")]),e._v(". Se você declarar uma opção com uma URL de valores remotos como "),a("code",[e._v("http://server/options?option2=${option.option2.value}")]),e._v(', então essa opção dependerá do valor da opção "option2".')]),e._v(" "),a("p",[e._v("Na GUI, quando as opções são carregadas, a opção2 será mostrada primeiro, e os valores remotos para a opção1 só serão carregados depois que um valor for selecionado para a opção2, e o valor será colocado na URL quando for carregado.")]),e._v(" "),a("p",[e._v('Se uma opção tiver dependências de outras opções que não tenham um valor definido, as referências incorporadas serão avaliadas como "" (string vazia) ao carregar\no URL.')]),e._v(" "),a("p",[e._v("Se uma opção tiver dependências de outras opções e os "),a("RouterLink",{attrs:{to:"/user-guide/job-options.html#formato-json"}},[e._v("dados JSON")]),e._v(" de valores remotos estiverem vazios (lista vazia ou objeto vazio), a opção mostrada na GUI indicará que o usuário deve selecionar valores para as opções necessárias. Isso permite que os fornecedores de modelos de opções indiquem que alguns ou todos os valores de opções dependentes são necessários para a opção atual antes de mostrar a entrada para a opção.")],1),e._v(" "),a("p",[e._v("É possível ter dependências em mais de uma opção e qualquer alteração em uma das dependências fará com que os valores da opção sejam recarregados a partir do URL remoto.")]),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("DICA")]),e._v(" "),a("p",[e._v("Também é possível declarar um ciclo de dependências entre os valores das opções, o que fará com que o recarregamento automático seja desabilitado. Nesse caso, o usuário deve clicar manualmente no botão recarregar para recarregar os valores da opção se uma dependência foi alterada.")])]),e._v(" "),a("h3",{attrs:{id:"expansao-de-variavel-em-urls-remotos"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#expansao-de-variavel-em-urls-remotos"}},[e._v("#")]),e._v(" Expansão de variável em URLs remotos")]),e._v(" "),a("p",[e._v('O URL declarado para "valuesUrl" pode incorporar variáveis que serão preenchidas com certos itens de contexto do '),a("em",[e._v("job")]),e._v(" ao fazer a solicitação remota. Isso ajuda a tornar os URLs mais genéricos e contextuais para o "),a("em",[e._v("Job")]),e._v(".")]),e._v(" "),a("p",[e._v("Dois tipos de expansões estão disponíveis, contexto de "),a("em",[e._v("Job")]),e._v(" e contexto de opção.")]),e._v(" "),a("p",[e._v("Para incluir as informações do "),a("em",[e._v("job")]),e._v(" na URL, especifique uma variável no formato "),a("code",[e._v("${job.property}")]),e._v(".")]),e._v(" "),a("p",[e._v("Propriedades disponíveis para o contexto do "),a("em",[e._v("Job")]),e._v(":")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("name")]),e._v(": nome do "),a("em",[e._v("Job")])]),e._v(" "),a("li",[a("code",[e._v("group")]),e._v(": Grupo do "),a("em",[e._v("Job")])]),e._v(" "),a("li",[a("code",[e._v("description")]),e._v(": descrição do "),a("em",[e._v("Job")])]),e._v(" "),a("li",[a("code",[e._v("project")]),e._v(": nome do projeto")]),e._v(" "),a("li",[a("code",[e._v("user.name")]),e._v(": Usuário executando o "),a("em",[e._v("Job")])]),e._v(" "),a("li",[a("code",[e._v("google.nodename")]),e._v(": Nome do nó do servidor")]),e._v(" "),a("li",[a("code",[e._v("google.serverUUID")]),e._v(": UUID do nó do servidor (modo de cluster)")]),e._v(" "),a("li",[a("code",[e._v("google.basedir")]),e._v(": Caminho do arquivo do diretório base do ("),a("code",[e._v("file://")]),e._v(" URLs apenas)")])]),e._v(" "),a("p",[e._v("Além disso, as propriedades "),a("code",[e._v("google.*")]),e._v(" podem ser especificadas sem o prefixo "),a("code",[e._v("job.")]),e._v(", por exemplo, "),a("code",[e._v("${google.basedir}")]),e._v(".")]),e._v(" "),a("p",[e._v("Para incluir informações de opção no URL, especifique uma variável do formulário ${option.property}:")]),e._v(" "),a("p",[e._v("Propriedades disponíveis para o contexto da opção:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("name")]),e._v(": Nome da opção atual")])]),e._v(" "),a("p",[e._v("Para incluir informações de valores de "),a("a",{attrs:{href:"/user-guide/job-options#opcao-remota-em-cascata"}},[e._v("opção remota em cascata")]),e._v(" no URL, especifique uma variável no formato ${option.name.value}:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("option.[name].value")]),e._v(': substitui o valor selecionado de outra opção pelo nome. Se a opção não for definida, uma string em branco ("") será substituída.')])]),e._v(" "),a("p",[a("em",[a("strong",[e._v("Exemplos")])])]),e._v(" "),a("div",{staticClass:"language-http extra-class"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("http:")]),e._v("//server.com/test?name=${option.name}\n")])])]),a("p",[e._v('Passa o nome da opção como o parâmetro de consulta "name" para o URL.')]),e._v(" "),a("div",{staticClass:"language-http extra-class"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("http:")]),e._v("//server.com/test?jobname=${job.name}&jobgroup=${job.group}\n")])])]),a("p",[e._v("Transmite o nome e grupo do "),a("em",[e._v("job")]),e._v(" como parâmetros de consulta.")]),e._v(" "),a("div",{staticClass:"language-http extra-class"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("http:")]),e._v("//server.com/branches?repository=${option.repository.value}\n")])])]),a("p",[e._v('Passa o valor da opção "repositório" selecionada ou "" (em branco) se não estiver definida. Esta opção torna-se dependente da opção "repositório" e se o valor do "repositório" mudar, os valores da opção remota para esta opção serão recarregados.')]),e._v(" "),a("h3",{attrs:{id:"falhas-de-solicitacao-remota"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#falhas-de-solicitacao-remota"}},[e._v("#")]),e._v(" Falhas de solicitação remota")]),e._v(" "),a("p",[e._v("Se a solicitação dos valores da opção remota falhar, o formulário da GUI exibirá uma mensagem de aviso:")]),e._v(" "),a("p",[a("img",{attrs:{src:"/assets/img/fig0901.png",alt:"fig0901"}})]),e._v(" "),a("p",[e._v("Neste caso, será permitida a opção de usar um campo de texto para definir o valor.")]),e._v(" "),a("h2",{attrs:{id:"vinculando-a-jobs-e-fornecendo-valores-de-opcao"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vinculando-a-jobs-e-fornecendo-valores-de-opcao"}},[e._v("#")]),e._v(" Vinculando a "),a("em",[e._v("Jobs")]),e._v(" e fornecendo valores de opção")]),e._v(" "),a("p",[e._v("Você pode criar um URL para vincular a um "),a("em",[e._v("Job")]),e._v(" específico e preencher previamente alguns dos valores de opção adicionando parâmetros de consulta de URL ao URL do "),a("em",[e._v("Job")]),e._v(".")]),e._v(" "),a("p",[e._v("Formato de parâmetros de consulta para opções:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("opt.NAME")]),e._v(": fornece um valor para uma opção chamada "),a("code",[e._v("NAME")])])]),e._v(" "),a("p",[e._v("Por exemplo, se o URL para "),a("em",[e._v("Job")]),e._v(" for:")]),e._v(" "),a("div",{staticClass:"language-http extra-class"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("http:")]),e._v("//localhost:4440/project/MyProject/job/show/ab698597-9753-4e98-bdab-90ebf395b0d0\n")])])]),a("p",[e._v("Em seguida, você pode preencher previamente os valores de "),a("code",[e._v("myopt1")]),e._v(" e "),a("code",[e._v("myotheropt")]),e._v(" anexando-o ao URL:")]),e._v(" "),a("div",{staticClass:"language-http extra-class"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[e._v("?opt.myopt1=some+value&opt.myotheropt=another+value\n")])])]),a("p",[e._v("O resultado seria:")]),e._v(" "),a("div",{staticClass:"language-http extra-class"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("http:")]),e._v("//localhost:4440/project/MyProject/job/show/ab698597-9753-4e98-bdab-90ebf395b0d0?opt.myopt1=some+value&opt.myotheropt=another+value\n")])])]),a("p",[e._v("Observação: certifique-se de escapar adequadamente das strings para os valores das opções e, se necessário, também para os nomes das opções.")])])}),[],!1,null,null,null);o.default=r.exports}}]);