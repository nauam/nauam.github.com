<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Opções de Job | Documentos</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/images/logo-black.png">
    <meta name="description" content="Ainda assim, existem dúvidas a respeito de como o julgamento imparcial das eventualidades aponta para a melhoria das formas de ação.">
    
    <link rel="preload" href="/assets/css/0.styles.d331a4a6.css" as="style"><link rel="preload" href="/assets/js/app.94749c3b.js" as="script"><link rel="preload" href="/assets/js/2.ed82773e.js" as="script"><link rel="preload" href="/assets/js/19.c61e76be.js" as="script"><link rel="prefetch" href="/assets/js/10.c12c89e6.js"><link rel="prefetch" href="/assets/js/11.33668774.js"><link rel="prefetch" href="/assets/js/12.2d1c71c1.js"><link rel="prefetch" href="/assets/js/13.ecc44a5b.js"><link rel="prefetch" href="/assets/js/14.ae938c59.js"><link rel="prefetch" href="/assets/js/15.dce3c346.js"><link rel="prefetch" href="/assets/js/16.7e1105c9.js"><link rel="prefetch" href="/assets/js/17.01901013.js"><link rel="prefetch" href="/assets/js/18.4550a5c4.js"><link rel="prefetch" href="/assets/js/20.9bf6df9a.js"><link rel="prefetch" href="/assets/js/21.840f5536.js"><link rel="prefetch" href="/assets/js/22.f7139545.js"><link rel="prefetch" href="/assets/js/3.8ad0696f.js"><link rel="prefetch" href="/assets/js/4.acea1853.js"><link rel="prefetch" href="/assets/js/5.80c84993.js"><link rel="prefetch" href="/assets/js/6.e2fb9f94.js"><link rel="prefetch" href="/assets/js/7.10ae753f.js"><link rel="prefetch" href="/assets/js/8.fbecdb9d.js"><link rel="prefetch" href="/assets/js/9.5c45180b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d331a4a6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Documentos</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Introdução" class="dropdown-title"><span class="title">Introdução</span> <span class="arrow down"></span></button> <button type="button" aria-label="Introdução" class="mobile-dropdown-title"><span class="title">Introdução</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/introduction/introduction.html" class="nav-link">
  Introdução
</a></li><li class="dropdown-item"><!----> <a href="/introduction/getting-help.html" class="nav-link">
  Conseguindo Ajuda
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Guia do Usuário" class="dropdown-title"><span class="title">Guia do Usuário</span> <span class="arrow down"></span></button> <button type="button" aria-label="Guia do Usuário" class="mobile-dropdown-title"><span class="title">Guia do Usuário</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/user-guide/projects.html" class="nav-link">
  Projetos
</a></li><li class="dropdown-item"><!----> <a href="/user-guide/jobs.html" class="nav-link">
  Jobs
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Linguagens" class="dropdown-title"><span class="title">Linguagens</span> <span class="arrow down"></span></button> <button type="button" aria-label="Linguagens" class="mobile-dropdown-title"><span class="title">Linguagens</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/user-guide/job-options.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Português
</a></li><li class="dropdown-item"><!----> <a href="/en/user-guide/job-options.html" class="nav-link">
  English
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Introdução" class="dropdown-title"><span class="title">Introdução</span> <span class="arrow down"></span></button> <button type="button" aria-label="Introdução" class="mobile-dropdown-title"><span class="title">Introdução</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/introduction/introduction.html" class="nav-link">
  Introdução
</a></li><li class="dropdown-item"><!----> <a href="/introduction/getting-help.html" class="nav-link">
  Conseguindo Ajuda
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Guia do Usuário" class="dropdown-title"><span class="title">Guia do Usuário</span> <span class="arrow down"></span></button> <button type="button" aria-label="Guia do Usuário" class="mobile-dropdown-title"><span class="title">Guia do Usuário</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/user-guide/projects.html" class="nav-link">
  Projetos
</a></li><li class="dropdown-item"><!----> <a href="/user-guide/jobs.html" class="nav-link">
  Jobs
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Linguagens" class="dropdown-title"><span class="title">Linguagens</span> <span class="arrow down"></span></button> <button type="button" aria-label="Linguagens" class="mobile-dropdown-title"><span class="title">Linguagens</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/user-guide/job-options.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Português
</a></li><li class="dropdown-item"><!----> <a href="/en/user-guide/job-options.html" class="nav-link">
  English
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Guia do Usuário</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/user-guide/projects.html" class="sidebar-link">Projetos</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/user-guide/jobs" class="sidebar-heading clickable open"><span>Jobs</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/user-guide/jobs.html" class="sidebar-link">Jobs</a></li><li><a href="/user-guide/creating-jobs.html" class="sidebar-link">Criação de jobs</a></li><li><a href="/user-guide/job-workflows.html" class="sidebar-link">Fluxo de trabalho</a></li><li><a href="/user-guide/job-options.html" aria-current="page" class="active sidebar-link">Opções de Job</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/user-guide/job-options.html#solicitando-ao-usuario" class="sidebar-link">Solicitando ao usuário</a></li><li class="sidebar-sub-header"><a href="/user-guide/job-options.html#tipos-de-entrada" class="sidebar-link">Tipos de entrada</a></li><li class="sidebar-sub-header"><a href="/user-guide/job-options.html#editor-de-opcoes" class="sidebar-link">Editor de opções</a></li><li class="sidebar-sub-header"><a href="/user-guide/job-options.html#definindo-uma-opcao" class="sidebar-link">Definindo uma opção</a></li><li class="sidebar-sub-header"><a href="/user-guide/job-options.html#uso-do-script" class="sidebar-link">Uso do script</a></li><li class="sidebar-sub-header"><a href="/user-guide/job-options.html#valores-de-escape" class="sidebar-link">Valores de escape</a></li><li class="sidebar-sub-header"><a href="/user-guide/job-options.html#opcoes-de-seguranca" class="sidebar-link">Opções de segurança</a></li><li class="sidebar-sub-header"><a href="/user-guide/job-options.html#valores-de-opcao-remota" class="sidebar-link">Valores de opção remota</a></li><li class="sidebar-sub-header"><a href="/user-guide/job-options.html#fornecedor-de-modelo-de-opcao" class="sidebar-link">Fornecedor de modelo de opção</a></li><li class="sidebar-sub-header"><a href="/user-guide/job-options.html#vinculando-a-jobs-e-fornecendo-valores-de-opcao" class="sidebar-link">Vinculando a Jobs e fornecendo valores de opção</a></li></ul></li></ul></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="opcoes-de-job"><a href="#opcoes-de-job" class="header-anchor">#</a> Opções de <em>Job</em></h1> <p>O <em>Jobs</em> pode ser configurado para solicitar a entrada de um usuário, definindo uma ou mais opções nomeadas. Uma opção modela um parâmetro nomeado que pode ser obrigatório ou opcional e inclui uma gama de opções que irão serão apresentado ao usuário quando o <em>Job</em> for executado.</p> <p>Os usuários fornecem opções digitando um valor ou selecionando em um menu de opções. Um padrão de validação garante que a entrada está em conformidade com o requisito da opção. Uma vez escolhido, o valor escolhido para a opção fica acessível aos comandos chamados pelo <em>Job</em>.</p> <p>As escolhas de opções podem ser modeladas como um conjunto estático ou de uma fonte dinâmica. As escolhas estáticas podem ser modeladas como uma lista separada por vírgulas na definição de <em>job</em>. Quando os valores de opção devem ser dinâmicos, o <em>Job</em> pode ser definido para usar uma URL para recuperar dados de opção de uma fonte externa. Habilitar <em>Jobs</em> para acessar fontes externas via URL abre a porta para integrar o com outras ferramentas e incorporar seus dados em <em>Job</em> workflows.</p> <h2 id="solicitando-ao-usuario"><a href="#solicitando-ao-usuario" class="header-anchor">#</a> Solicitando ao usuário</h2> <p>O efeito óbvio de definir opções de <em>Job</em> é sua aparência para o usuário executando o <em>Job</em>. Os usuários verão uma página chamada &quot;Escolha Opções de execução...&quot; onde as opções de entrada e de menu devem ser configuradas.</p> <p>Usuários de linha de comando executando <em>Jobs</em> via shell <code>run</code>
ferramenta também irá especificar opções como uma string de argumento.</p> <div class="custom-block warning"><p class="custom-block-title">AVISO</p> <p>O comando <code>run</code> não solicita ao usuário as opções necessárias, então você deve especificá-las diretamente.</p></div> <p>Vale a pena gastar um momento para considerar como as opções se tornam parte da interface do usuário para <em>Jobs</em> e pensar um pouco sobre o próximo nível de formalização do procedimento.</p> <ul><li>Convenção de nomenclatura e descrição: Visualize como o usuário lerá o nome da opção e julgará sua finalidade a partir da descrição fornecida.</li> <li>Opções obrigatórias: Tornar uma opção obrigatória significa que o <em>Job</em> falhará se um usuário não especificar um valor que não seja em branco. Em outras palavras, um valor em branco ou ausente não é permitido para a opção.</li> <li>Restrições de entrada e validação: Se você precisa fazer com que o valor da opção seja um tanto aberto, considere como você pode criar salvaguardas para controlar sua escolha.</li></ul> <h2 id="tipos-de-entrada"><a href="#tipos-de-entrada" class="header-anchor">#</a> Tipos de entrada</h2> <p>Tipos de entrada de opção definem como a opção é apresentada na GUI e como ela é usada quando o <em>Job</em> é executado.</p> <p>Tipos de entrada:</p> <ul><li>&quot;Simples&quot;
<ul><li>uma opção normal que é mostrada em texto claro</li></ul></li> <li>&quot;Seguro&quot;
<ul><li>uma opção segura que é obscurecida no momento da entrada do usuário e cujo valor não é armazenado no banco de dados. Veja <a href="/user-guide/job-options.html#opcoes-de-seguranca">opções de segurança</a>.</li></ul></li> <li>&quot;Autenticação remota segura&quot;
<ul><li>uma opção segura que é usada apenas para autenticação remota e não é exposta em scripts ou comandos. Consulte <a href="/user-guide/job-options.html#opcoes-de-autenticacao-remota-segura">opções de autenticação remota segura</a>.</li></ul></li></ul> <h2 id="editor-de-opcoes"><a href="#editor-de-opcoes" class="header-anchor">#</a> Editor de opções</h2> <p>As opções podem ser criadas para qualquer <em>Job</em> armazenado. A página de edição <em>Job</em> contém uma área que exibe um resumo das opções existentes e um link para adicionar novas ou editar as existentes.</p> <p><img src="/assets/img/fig0501.png" alt="Adicionar link de opção"></p> <p>O resumo de opções mostra cada opção e seu valor padrão, se os definir.</p> <p>Clicar no link &quot;editar&quot; abre o editor de opções.</p> <p><img src="/assets/img/fig0503.png" alt="Editor de opções"></p> <p>O editor de opções exibe um resumo expandido para cada opção definida. Cada opção é listada com seu resumo de uso, descrição, lista de valores e quaisquer restrições. Pressionar o link &quot;Adicionar uma opção&quot; abrirá um formulário para definir um novo parâmetro. Pressionar o link &quot;Fechar&quot; recolherá o editor de opções e retornará à visualização resumida.</p> <p>Mover o mouse sobre qualquer linha no editor de opções revela links para excluir ou editar a opção destacada. Pressionar o ícone de remoção exibirá um prompt confirmando que você deseja excluir essa opção do <em>Job</em>.</p> <p>Clicar no link &quot;editar&quot; abre um novo formulário que permite modificar todos os aspectos dessa opção.</p> <p>As opções também podem ser definidas como parte de uma definição de <em>job</em> e posteriormente carregadas no servidor . Consulte <a href="/user-guide/document-format-reference/job-v20.html">job-xml</a> e <a href="/user-guide/document-format-reference/job-yaml-v12.html">job-yaml</a> e <a href="/https://google.github.io/cli/commands/#jobs">rd <em>jobs</em></a> páginas se você preferir usar uma definição textual de <em>Job</em>.</p> <h2 id="definindo-uma-opcao"><a href="#definindo-uma-opcao" class="header-anchor">#</a> Definindo uma opção</h2> <h3 id="opcoes-de-texto"><a href="#opcoes-de-texto" class="header-anchor">#</a> Opções de texto</h3> <p>Novas opções podem ser definidas pressionando o link &quot;Adicionar uma opção&quot;, enquanto as existentes podem ser alteradas pressionando o link &quot;editar&quot;.</p> <p>Escolha &quot;Texto&quot; no Tipo de Opção:</p> <p><img src="/assets/img/fig0502.png" alt="Formulário de edição de opção"></p> <p>O formulário de definição de opções é organizado em várias áreas:</p> <h3 id="identificacao"><a href="#identificacao" class="header-anchor">#</a> Identificação</h3> <p>Aqui você fornece o nome e a descrição da opção. O nome se torna parte dos argumentos aceitáveis para o <em>Job</em>, enquanto a descrição será fornecida como texto de ajuda para os usuários que executam o <em>Job</em>.</p> <p>O valor padrão será pré-selecionado na GUI quando a opção for apresentada.</p> <h3 id="tipo-de-entrada"><a href="#tipo-de-entrada" class="header-anchor">#</a> Tipo de entrada</h3> <p>Escolha entre &quot;Simples&quot;, &quot;Data&quot;, &quot;Seguro&quot; e &quot;Autenticação Remota Segura&quot;. Para tipos de entrada diferentes de &quot;Simples&quot;, a opção de vários valores será desabilitada.</p> <h3 id="formato-de-data"><a href="#formato-de-data" class="header-anchor">#</a> Formato de data</h3> <p>Se o tipo de entrada &quot;Data&quot; for escolhido, você pode inserir um formato de data a ser usado ao selecionar a data na interface do usuário. Usando o <a href="https://momentjs.com/docs/#/displaying/format/" target="_blank" rel="noopener noreferrer">formato momentjs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="valor-padrao"><a href="#valor-padrao" class="header-anchor">#</a> Valor padrão</h3> <p>Um valor padrão será definido automaticamente para a opção se não for especificado de outra forma pelo usuário, mesmo se não for especificado entre os argumentos ao executar um <em>job</em> por meio da linha de comando ou API. Observe que um valor em branco pode ser especificado por meio da linha de comando ou API, que substituirá o uso do valor padrão.</p> <h3 id="valores-permitidos"><a href="#valores-permitidos" class="header-anchor">#</a> Valores permitidos</h3> <p>Os valores permitidos fornecem um modelo de escolhas possíveis. Isso pode conter uma lista estática de valores ou um URL para um servidor que fornece dados de opção. Os valores podem ser especificados como uma lista separada por vírgulas, conforme visto acima, mas também podem ser solicitados de uma fonte externa usando um &quot;URL remoto&quot;.</p> <h3 id="restricoes"><a href="#restricoes" class="header-anchor">#</a> Restrições</h3> <p>Define os critérios sobre os quais a entrada deve ser aceita ou apresentada. As escolhas de opções podem ser controladas usando a restrição &quot;Enforced from values&quot;. Quando definido como &quot;true&quot;, o apresentará apenas um menu pop-up. Se definido como &quot;false&quot;, um campo de texto também será apresentado. Insira uma expressão regular no campo &quot;Match Regular Expression&quot; que o <em>Job</em> avaliará quando executado.</p> <h3 id="requerimento"><a href="#requerimento" class="header-anchor">#</a> Requerimento</h3> <p>Indica se o <em>Job</em> só pode ser executado se um valor valido for fornecido para essa opção. Escolha &quot;Não&quot; para indicar que um valor em branco é permitido e escolha &quot;Sim&quot; para indicar que um valor em branco não é permitido.</p> <p>Se um valor padrão for definido, ele será usado quando nenhum valor for fornecido, a menos que um valor em branco seja permitido e seja explicitamente especificado.</p> <p><img src="/assets/img/fig-option-multival.png" alt="Formulário de opção de valor múltiplo"></p> <h3 id="multi-valor"><a href="#multi-valor" class="header-anchor">#</a> Multi-valor</h3> <p>Define se a entrada do usuário pode consistir em vários valores. Escolher &quot;Não&quot; indica que apenas um único valor pode ser escolhido como entrada. Escolher &quot;Sim&quot; indica que o usuário pode selecionar vários valores de entrada dos valores permitidos e/ou inserir vários valores próprios.</p> <h3 id="delimitador"><a href="#delimitador" class="header-anchor">#</a> Delimitador</h3> <p>A string delimitadora será usada para separar os vários valores quando o <em>Job</em> for executado.</p> <h3 id="selecionar-todos-os-valores-por-padrao"><a href="#selecionar-todos-os-valores-por-padrao" class="header-anchor">#</a> Selecionar todos os valores por padrão</h3> <p>Se marcada, e nenhum valor padrão é especificado, todos os valores remotos ou locais serão selecionados por padrão.</p> <p>Quando estiver satisfeito com a definição da opção, pressione o botão &quot;Salvar&quot; para adicioná-la à definição <em>Job</em>. Pressionar o botão &quot;Cancelar&quot; descartará as alterações e fechará o formulário.</p> <p>Uso (veja abaixo)</p> <p><img src="/assets/img/fig-option-usage.png" alt="Uso da opção"></p> <h3 id="variavel-de-carimbo-de-data-hora-da-opcao"><a href="#variavel-de-carimbo-de-data-hora-da-opcao" class="header-anchor">#</a> Variável de carimbo de data/hora da opção</h3> <p>Você pode usar a string <code>${DATE:format}</code> como um valor de opção do <em>job</em> (tanto como valor padrão ou como entrada pelo usuário), que será convertido quando o <em>job</em>/comando for executado. Esta variável também permite adicionar ou remover dias como você pode ver abaixo.</p> <p><code>${DATE:format}</code> data atual no formato usado pelo Java <a href="https://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html" target="_blank" rel="noopener noreferrer">SimpleDateFormatter<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><code>${DATE+2:format}</code> daqui a dois dias</p> <p><code>${DATE-2:format}</code> dois dias atrás</p> <h3 id="tipo-de-opcao-de-arquivo"><a href="#tipo-de-opcao-de-arquivo" class="header-anchor">#</a> Tipo de opção de arquivo</h3> <p>Escolha &quot;Arquivo&quot; no Tipo de Opção:</p> <p><img src="/assets/img/fig-newoption-file.png" alt="Formulário de edição de opção de arquivo"></p> <p>O nome e a descrição da opção podem ser inseridos.</p> <p>Obrigatório</p> <p>: Escolha se deseja que a opção tenha um valor.</p> <p>Uso da opção de arquivo:</p> <p>A variável <code>option.NAME</code> conterá um ID único que identifica o arquivo enviado.</p> <p><code>file.NAME</code> será o caminho do arquivo local.</p> <p><code>file.NAME.filename</code> será o nome do arquivo original (se disponível).</p> <p><code>file.NAME.sha</code> será o hash SHA256 do arquivo.</p> <h2 id="uso-do-script"><a href="#uso-do-script" class="header-anchor">#</a> Uso do script</h2> <p>Os valores das opções podem ser passados para scripts como um argumento ou referenciados dentro do script por meio de um token nomeado. Cada valor de opção é definido nas variáveis de contexto de Opções como <code>option.NAME</code>.</p> <p>Consulte a seção [Variáveis ​​de contexto](/user-guide/job-workflows.md # context-variables).</p> <p><strong>Exemplo:</strong></p> <p>Um <em>Job</em> chamado &quot;hello&quot;, tem uma opção chamada &quot;message&quot;.</p> <p>A assinatura da opção &quot;hello&quot; <em>Job</em> seria: <code>-message &lt;&gt;</code>.</p> <p><img src="/assets/img/fig0504.png" alt="Uso da opção"></p> <p>Os argumentos passados ​​para o script são definidos como <code>${option.message}</code>.</p> <p>Aqui está o conteúdo deste script simples que mostra os vários
formulários para acessar o valor da opção &quot;message&quot;.</p> <div class="language-bash .numberLines extra-class"><pre class="language-bash"><code><span class="token shebang important">#!/bin/sh</span>
<span class="token builtin class-name">echo</span> <span class="token assign-left variable">envvar</span><span class="token operator">=</span><span class="token variable">$RDoptionMESSAGE</span><span class="token punctuation">;</span> <span class="token comment">#mensagem de acesso como variável de ambiente.echo args = $ 1; # valor lido passado para o vetor de argumento</span>
<span class="token builtin class-name">echo</span> message <span class="token operator">=</span> @ option.message @<span class="token punctuation">;</span> <span class="token comment"># mensagem de acesso via sintaxe de token de substituição</span>
</code></pre></div><p>Quando o usuário executa o <em>job</em> &quot;hello&quot;, será solicitado o
valor da &quot;mensagem&quot;.</p> <p><img src="/assets/img/fig0505.png" alt="Opção inserida"></p> <p>Vamos supor que eles escolheram a palavra &quot;howdy&quot; em resposta. A saída do <em>Job</em> será:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>envar <span class="token operator">=</span> howdy
args <span class="token operator">=</span> howdy
mensagem <span class="token operator">=</span> howdy
</code></pre></div><p>Se você definir a opção como <em>Required</em>, o <em>Job</em> não será executado, a menos que o usuário forneça um valor que não esteja em branco.</p> <p>Se você definir a opção como não <em>Required</em>, o valor da opção poderá ficar em branco e especificar um valor em branco resultará em:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>envar <span class="token operator">=</span>
args <span class="token operator">=</span>
mensagem <span class="token operator">=</span>
</code></pre></div><p>Você pode usar o <em>Valor Padrão</em> de uma opção para fornecer um valor caso o usuário não o especifique. Na GUI, o <em>Valor Padrão</em> será automaticamente apresentado na página Execução de <em>Job</em>. Na CLI ou API, deixando de fora um argumento <code>-option</code> para um <em>job</em> usar o valor padrão.</p> <p>Você também pode manipular valores padrão em um script, se sua opção não especificar um ou se o usuário especificar um valor em branco para a opção:</p> <p><strong>Variável de ambiente:</strong></p> <p>Como precaução, você pode testar a existência da variável e talvez definir um valor padrão. Para testar sua existência, você pode usar:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>teste -s <span class="token string">&quot;$ RDoptionNAME&quot;</span>
</code></pre></div><p>Você também pode usar um recurso Bash que testa e padroniza para um valor:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token variable">${RDoptionNAME<span class="token operator">:=</span>mydefault}</span>
</code></pre></div><p><strong>Token de substituição:</strong></p> <p>Se a opção estiver em branco ou não configurada, o token será substituído por uma string em branco. Você pode escrever seu script de forma um pouco mais defensiva e alterar a implementação da seguinte forma:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>mensagem <span class="token operator">=</span> <span class="token string">&quot;@ opção.mensagem @&quot;</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span>-z <span class="token string">&quot;$ message&quot;</span><span class="token punctuation">]</span>
então
mensagem <span class="token operator">=</span> mydefault
<span class="token keyword">fi</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">AVISO</p> <p>A sintaxe do token de substituição só é suportada em passos de script embutido (ou seja, não em arquivo de script ou passos de comando).</p></div> <p><strong>Token de substituição de escape:</strong></p> <p>Se você quiser usar o caractere <code>@</code> de uma forma que pareça um token de substituição, você pode escapar dele usando <code>@@</code>, ou seja, dobrando-o.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># escape do sinal @ para evitar expansão antes de @ option.domain @</span>
email <span class="token operator">=</span> <span class="token string">&quot;usuário@@mail.@option.domain@&quot;</span>

<span class="token comment"># Se o primeiro sinal @ vier imediatamente antes do token, use três @</span>
email <span class="token operator">=</span> <span class="token string">&quot;usuário@@@opção.domínio@&quot;</span>
</code></pre></div><p>Neste exemplo, o <code>@@@option.domain@</code> resultará em <code>@mydomain</code>,
e <code>@@mail.@option.domain2@</code> resultará em <code>@mail.mydomain</code>.</p> <p>Se você não escapar do <code>@</code> no segundo exemplo, então <code>@mail.@</code>
será expandido para um valor ausente, resultando em uma string em branco.</p> <p>Se você não escapar de <code>@</code> no segundo exemplo, então <code>@mail.@</code> Será expandido para um valor ausente, resultando em uma string em branco.</p> <p>Você não precisa escapar do sinal <code>@</code> em todos os casos, apenas quando pode parecer um token de expansão. Se houver qualquer caractere de espaço em branco antes do próximo sinal <code>@</code>, ele não precisa ser escapado:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># primeiro sinal @ não precisa de escape</span>
<span class="token assign-left variable">text</span><span class="token operator">=</span><span class="token string">&quot;Hi user@somewhere, @option.greeting@!&quot;</span>
</code></pre></div><h2 id="valores-de-escape"><a href="#valores-de-escape" class="header-anchor">#</a> Valores de escape</h2> <p>Quando os argumentos para o script ou o conteúdo de uma string de execução de Comando são
avaliadas, referências de propriedades embutidas como <code>${option.name}</code> são substituídas por
os valores inseridos por um usuário.</p> <p>Para evitar que qualquer entrada do usuário inclua caracteres especiais do shell (acidentalmente ou maliciosamente), qualquer argumento que tenha referências incorporadas será colocado entre aspas para o shell.</p> <p>Você também deve ter cuidado em como os argumentos para scripts são usados ​​em um script.</p> <p>Por exemplo, se você tiver um passo de script com string de argumento <code>${option.message}</code>, e script:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$1</span>
</code></pre></div><p>Então este script irá expandir parcialmente o valor <code>${option.message}</code> uma segunda vez, mesmo que tenha sido citado corretamente para passar para seu script.</p> <p>Em vez disso, você deve fazer algo assim:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
eco <span class="token string">&quot;<span class="token variable">$1</span>&quot;</span>
</code></pre></div><p>O que permite que o shell trate corretamente o valor de entrada citando-o.</p> <h3 id="usando-valores-sem-escape"><a href="#usando-valores-sem-escape" class="header-anchor">#</a> Usando valores sem escape</h3> <p>Se o <em>job</em> precisa fornecer uma opção em sua forma bruta, sem escape, é possível usar a chave de pesquisa de contexto <code>unquotedoption</code> ao invés de <code>option</code>.</p> <p>Por exemplo:
O valor da opção <code>${option.name}</code> pode ser acessado sem nenhum escape referenciando-o como <code>${unquotedoption.name}</code>.
Em um script similarmente use <code>@unquotedoption.name@</code> ao invés de <code>@option.name@</code>.</p> <div class="custom-block warning"><p class="custom-block-title">AVISO</p> <p>O uso de valores não escapados pode expor o ambiente a riscos de segurança, como injeção de comando (mas não se limitando à injeção de comando!).</p></div> <blockquote><p>Considere o exemplo a seguir, onde um usuário tem permissão para fornecer uma lista de diretórios para um <em>job</em> de backup hipotético. Vamos supor também que <em>job</em> processou a lista de diretórios com <code>tar -zcvf /tmp/archive.tgz @unquotedoption.targetdirs@</code>. Então, um usuário mal-intencionado pode enganar o <em>job</em> para que ele execute um comando extra fornecendo este valor:
<code>targetdirs</code>:<code>/etc/home/var/lib/redis; rm -rf/</code>.</p></blockquote> <p>Então, dependendo dos privilégios do usuário, o script felizmente destruirá tantos diretórios e arquivos quanto puder no nó alvo. Você pode limitar o risco adotando máscaras regex apropriadas, codificando o script de forma defensiva e usando o princípio de privilégio mínimo.</p> <h2 id="opcoes-de-seguranca"><a href="#opcoes-de-seguranca" class="header-anchor">#</a> Opções de segurança</h2> <p>As opções podem ser marcadas como Seguras, para mostrar um prompt de senha na GUI, em vez de um campo de texto normal ou menu suspenso. Os valores das opções seguras não são armazenados com o Execution, assim como os outros valores das opções.</p> <p>Existem dois tipos de opções seguras:</p> <ul><li>Seguro
<ul><li>esses valores de opção são expostos em scripts e comandos.</li></ul></li> <li>Autenticação remota segura
<ul><li>esses valores de opção <strong>não</strong> são expostos em scripts e comandos e são usados apenas por <em>Nó</em> Executores para autenticar em <em>Nós</em> e executar comandos.</li></ul></li></ul> <p>As opções seguras não suportam entrada de vários valores.</p> <p>As opções seguras não podem ser usadas como entrada de autenticação para executores do <em>Nó</em>, você deve usar uma opção de autenticação remota segura descrita abaixo.</p> <h3 id="nota-importante"><a href="#nota-importante" class="header-anchor">#</a> Nota importante</h3> <p>Os valores da opção &quot;segura&quot; não são armazenados no banco de dados do quando o <em>Job</em> é executado, mas o valor inserido
é exposto para uso em scripts e comandos. Certifique-se de reconhecer essas implicações de segurança antes de usá-los. As opções seguras estão disponíveis para uso em scripts e comandos como qualquer outro valor de opção:</p> <ul><li>como argumentos de texto simples usando <code>${option.name}</code> <ul><li>Usar o valor da opção como um argumento para um comando pode expor o valor do texto simples na tabela de processo do sistema</li></ul></li> <li>como variáveis de ambiente de texto simples na execução remota e local de script como <code>$RDoptionNAME</code> <ul><li>Scripts locais e possivelmente remotos podem receber este valor em seu ambiente</li></ul></li> <li>como tokens de texto simples expandidos em scripts remotos como <code>@option.name@</code>.
<ul><li>Os passos do fluxo de <em>Job</em> de script embutido que contêm uma expansão de token serão expandidas em um arquivo temporário e o arquivo temporário conterá o valor da opção de texto simples.</li></ul></li></ul> <div class="custom-block tip"><p class="custom-block-title">DICA</p> <p>Quando passados ​​como argumentos para <em>Job</em> References, eles só podem ser passados ​​como o valor de outra opção Secure. Consulte <a href="/user-guide/job-options.html#usando-opcoes-seguras-com-referencias-job">Usando opções seguras com referências de <em>Job</em></a>.</p></div> <h3 id="opcoes-de-autenticacao-remota-segura"><a href="#opcoes-de-autenticacao-remota-segura" class="header-anchor">#</a> Opções de autenticação remota segura</h3> <p>O <a href="/Administration/projects/node-execution/ssh.html">provedor SSH</a> integrado para execução de nó permite o uso de senhas para mecanismos de autenticação SSH e/ou Sudo, e as senhas são fornecidas por Opções de autenticação remota segura definidas em um <em>Job</em>.</p> <p>As opções de autenticação remota segura têm algumas limitações em comparação com as opções simples e seguras:</p> <ul><li>Os valores inseridos pelo usuário não estão disponíveis para script normal e expansão de valor de opção de comando. Isso significa que eles só podem ser usados para fins de autenticação remota.</li></ul> <h3 id="usando-opcoes-seguras-com-referencias-job"><a href="#usando-opcoes-seguras-com-referencias-job" class="header-anchor">#</a> Usando opções seguras com referências <em>Job</em></h3> <p>Ao definir um <a href="/user-guide/node-steps/builtin.html#passo-de-referencia-de-job">passo de Referência de <em>Job</em> em um fluxo de trabalho</a>, você pode especificar os argumentos que são transmitidos a ela. Você pode passar os valores da Opção segura e da Opção de autenticação remota segura de um <em>job</em> de nível superior para uma Referência de <em>job</em>, mas os valores de opção <em>não podem ser passados para outra opção de um tipo diferente</em>. Portanto, um <em>job</em> pai só pode passar valores de opção para a referência de <em>job</em> se o tipo de opção for o mesmo entre os <em>jobs</em>.</p> <p>Essa restrição é para manter o projeto de segurança dessas opções:</p> <ol><li>As opções seguras não devem ser armazenadas no banco de dados de execução do , portanto, não devem ser usadas como valores de opção simples.</li> <li>As opções de autenticação remota segura não devem ser usadas em scripts/comandos, portanto, não devem ser usadas como valores de opção segura ou simples.</li></ol> <p>Como exemplo, aqui estão dois <em>jobs</em>, <em>Job</em> A e <em>Job</em> B, que definem algumas opções:</p> <ul><li><em>Job</em> A
<ul><li>Opção &quot;plain1&quot; - Simples</li> <li>Opção &quot;seguro1&quot; - Seguro</li> <li>Opção &quot;auth1&quot; - Autenticação remota segura</li></ul></li> <li><em>Job</em> B
<ul><li>Opção &quot;plain2&quot; - Simples</li> <li>Opção &quot;seguro2&quot; - Seguro</li> <li>Opção &quot;auth2&quot; - Autenticação remota segura</li></ul></li></ul> <p>Se <em>Job</em> A define uma referência de <em>Job</em> para chamar <em>Job</em> B, então o único mapeamento válido é mostrado abaixo:</p> <ul><li>plain1 -&gt; plain2</li> <li>secure1 -&gt; secure2</li> <li>auth1 -&gt; auth2</li></ul> <p>Portanto, os argumentos para a Referência de <em>Job</em> podem ter a seguinte aparência:</p> <ul><li>plain2 ${option.plain1}</li> <li>secure2 ${option.secure1}</li> <li>auth2 ${option.auth1}</li></ul> <blockquote><p>Observação: se você definir argumentos de maneira incorreta, as opções de autenticação remota segura e segura não serão definidas quando a referência de <em>job</em> forem ligadas. As opções simples se comportarão da maneira como se comportam em argumentos de comando ou script e serão deixadas como estão, como referências de propriedade não interpretadas.</p></blockquote> <h3 id="opcoes-seguras-usando-armazenamento-de-chaves"><a href="#opcoes-seguras-usando-armazenamento-de-chaves" class="header-anchor">#</a> Opções seguras usando armazenamento de chaves</h3> <p>As opções seguras podem especificar um caminho de armazenamento em vez de um valor padrão. Este caminho para o <a href="/Administration/security/key-storage.html">Key Storage Facility</a> será carregado como o valor da opção quando um não for fornecido.</p> <p>O caminho deve indicar uma entrada de <code>password</code> armazenada na instalação de armazenamento.</p> <p><img src="/assets/img/jobs-options-secure-storage-path.png" alt="Caminho de armazenamento para opção segura"></p> <h2 id="valores-de-opcao-remota"><a href="#valores-de-opcao-remota" class="header-anchor">#</a> Valores de opção remota</h2> <p>Um modelo de valores de opção pode ser recuperado de uma fonte externa chamada de <em>provedor de modelo de opção</em>. Quando <code>valuesUrl</code> é especificado para uma opção, o modelo de valores permitidos é recuperado do URL especificado.</p> <p>Isso é útil em alguns cenários quando o google é usado para coordenar processos que dependem de outros sistemas:</p> <ul><li>Implantar pacotes ou artefatos produzidos por um servidor de construção ou CI, por exemplo, Jenkins.
<ul><li>Uma lista de artefatos de construção recentes do Jenkins pode ser importada como dados de opções, para que um usuário possa escolher um nome de pacote apropriado para implantar em uma lista.</li></ul></li> <li>Seleção de um conjunto de ambientes disponíveis, definidos em um CMDB</li> <li>Qualquer situação na qual variáveis de entrada para seus <em>Jobs</em> devem ser selecionadas a partir de algum conjunto de valores produzidos por um sistema diferente.</li></ul> <h2 id="fornecedor-de-modelo-de-opcao"><a href="#fornecedor-de-modelo-de-opcao" class="header-anchor">#</a> Fornecedor de modelo de opção</h2> <p>O provedor de modelo de opção é um mecanismo que permite que as opções definidas para um <em>Job</em> tenham alguns dos valores de entrada possíveis fornecidos por um serviço remoto ou banco de dados.</p> <p>Os provedores de modelo de opção são configurados por opção (onde um <em>Job</em> pode ter zero ou mais opções).</p> <h3 id="requisitos"><a href="#requisitos" class="header-anchor">#</a> Requisitos</h3> <ol><li>Os dados do modelo de opções devem ser <a href="http://www.json.org" target="_blank" rel="noopener noreferrer">formatados em JSON<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li> <li>Deve estar acessível via HTTP(S) ou no disco local para o servidor do .</li> <li>Deve estar em uma das duas estruturas JSON, <em>todos</em>:
<ul><li>Uma matriz de valores de string</li> <li>OU, uma matriz de mapas, cada um com duas entradas, <code>name</code> e <code>value</code>.</li></ul></li> <li>Por padrão, a resposta HTTP(S) deve incluir o tipo de conteúdo <code>application/json</code> no cabeçalho.
Caso isso não possa ser controlado, o atributo <code>project.jobs.disableRemoteOptionJsonCheck</code> pode ser definido como <code>true</code> nas configurações do projeto.</li></ol> <h3 id="configuracao"><a href="#configuracao" class="header-anchor">#</a> Configuração</h3> <p>Cada entrada de opção para um <em>Job</em> pode ser configurada para obter o conjunto de valores possíveis de um URL remoto. Se você está criando jobs por meio do <a href="/user-guide/document-format-reference/job-v20.html#opcao">formato de arquivo job.xml</a>, simplesmente adicione um atributo <code>valuesUrl</code> para a<code>&lt;option&gt;</code>. Se você estiver modificando o <em>Job</em> na interface web do , poderá inserir um URL no campo &quot;URL remoto&quot; para a opção.
por exemplo:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">valuesUrl</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">&quot;</span>http://site.example.com/values.json<span class="token punctuation">&quot;</span></span> <span class="token attr-name">...</span><span class="token punctuation">/&gt;</span></span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">DICA</p> <p>O esquema de URL do arquivo também é aceitável (por exemplo, <code>file:/path/to/job/options/optA.json</code>).</p></div> <p>Os dados do valor devem ser retornados no formato de dados JSON descrito abaixo.</p> <h3 id="formato-json"><a href="#formato-json" class="header-anchor">#</a> formato JSON</h3> <p>Três estilos de dados de retorno são suportados: lista simples, objeto simples e uma lista de nome/valor. Para uma lista simples, os valores da lista serão exibidos em uma lista pop-up ao executar o <em>Job</em>. Se um objeto simples ou pares nome/valor forem retornados, então o <code>name</code> será exibido na lista, mas o <code>value</code> será usado como a entrada.</p> <h3 id="exemplos"><a href="#exemplos" class="header-anchor">#</a> Exemplos</h3> <p>Lista Simples:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span><span class="token string">&quot;valor x para teste&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;valor y para teste&quot;</span><span class="token punctuation">]</span>
</code></pre></div><p>Isso irá preencher o menu de seleção com os valores fornecidos.</p> <p>Objeto simples:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span> <span class="token property">&quot;Name1&quot;</span><span class="token operator">:</span> <span class="token string">&quot;value1&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;Name2&quot;</span><span class="token operator">:</span><span class="token string">&quot;value2&quot;</span> <span class="token punctuation">}</span>
</code></pre></div><p>Isso irá preencher o menu de seleção para mostrar os nomes e usar os valores.</p> <p>Lista de valores de nomes:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;X Label&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;x value&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Y Label&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;y value&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;A Label&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;a value&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><p>Para opções com vários valores, se o resultado for uma lista de objetos e alguns tiverem uma propriedade <code>selected</code> de <code>true</code>, esses valores serão selecionados por padrão.</p> <p>Para uma opção de valor único, o primeiro resultado com <code>selected=true</code> será selecionado (se houver).</p> <p>Lista de valores de nomes com seleções padrão:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;X Label&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;x value&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;selected&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Y Label&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;y value&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;A Label&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;a value&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;selected&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><h3 id="parametros-de-conexao-de-url"><a href="#parametros-de-conexao-de-url" class="header-anchor">#</a> Parâmetros de conexão de URL</h3> <p>Você pode configurar tempos limites globalmente conforme descrito em <a href="/administration/configuration/config-file-reference.html#config.properties">Configuração - Parâmetros de conexão da URL da opção remota do <em>Job</em></a>.</p> <p>Você também pode especificar esses parâmetros de conexão por URL:</p> <p><code>timeout</code>
: tempo limite do soquete em segundos</p> <p><code>contimeout</code>
: tempo limite de conexão em segundos</p> <p><code>retry</code>
: repetir a contagem se não houver resposta do servidor</p> <p>Para definir isso em uma URL remota de Option, adicione-os como a parte &quot;fragmento&quot; da URL, após o caractere <code>#</code> como:</p> <div class="language-http extra-class"><pre class="language-http"><code><span class="token header-name keyword">http:</span>//host/mypath#timeout=60;contimeout=5;retry=1
</code></pre></div><p>Use <code>key=value</code> para um parâmetro e separe vários parâmetros com o caractere<code>;</code>.</p> <h3 id="opcoes-remotas-em-cascata"><a href="#opcoes-remotas-em-cascata" class="header-anchor">#</a> Opções remotas em cascata</h3> <p>As opções em cascata permitem que o URL de valores remotos de uma opção incorpore os valores inseridos pelo usuário para outras opções ao executar um <em>Job</em>. Quando o usuário insere ou seleciona um valor para uma das outras opções, o JSON remoto é atualizado para a opção atual.</p> <p>Isso fornece um mecanismo para declarar conjuntos hierárquicos ou dependentes de valores de opção.</p> <p>Por exemplo. se você quiser uma opção para escolher um &quot;repositório&quot; e outra opção para selecionar um &quot;ramo&quot; específico dentro desse repositório. Defina seu provedor de opções para responder corretamente com base no valor de &quot;repositório&quot; selecionado e defina sua URL de opção remota para incluir uma referência ao valor de opção de &quot;repositório&quot;. A GUI do irá então recarregar os valores JSON da URL remota e inserir o valor correto da opção &quot;repositório&quot; ao carregar os valores da opção &quot;branch&quot;. Se o usuário alterar o repositório selecionado, os valores do branch serão atualizados automaticamente.</p> <p>Você pode declarar a dependência de uma opção para outra incorporando referências de propriedade na URL de valores remotos. A referência da propriedade tem o formato <code>${option.[name].value}</code>. Se você declarar uma opção com uma URL de valores remotos como <code>http://server/options?option2=${option.option2.value}</code>, então essa opção dependerá do valor da opção &quot;option2&quot;.</p> <p>Na GUI, quando as opções são carregadas, a opção2 será mostrada primeiro, e os valores remotos para a opção1 só serão carregados depois que um valor for selecionado para a opção2, e o valor será colocado na URL quando for carregado.</p> <p>Se uma opção tiver dependências de outras opções que não tenham um valor definido, as referências incorporadas serão avaliadas como &quot;&quot; (string vazia) ao carregar
o URL.</p> <p>Se uma opção tiver dependências de outras opções e os <a href="/user-guide/job-options.html#formato-json">dados JSON</a> de valores remotos estiverem vazios (lista vazia ou objeto vazio), a opção mostrada na GUI indicará que o usuário deve selecionar valores para as opções necessárias. Isso permite que os fornecedores de modelos de opções indiquem que alguns ou todos os valores de opções dependentes são necessários para a opção atual antes de mostrar a entrada para a opção.</p> <p>É possível ter dependências em mais de uma opção e qualquer alteração em uma das dependências fará com que os valores da opção sejam recarregados a partir do URL remoto.</p> <div class="custom-block tip"><p class="custom-block-title">DICA</p> <p>Também é possível declarar um ciclo de dependências entre os valores das opções, o que fará com que o recarregamento automático seja desabilitado. Nesse caso, o usuário deve clicar manualmente no botão recarregar para recarregar os valores da opção se uma dependência foi alterada.</p></div> <h3 id="expansao-de-variavel-em-urls-remotos"><a href="#expansao-de-variavel-em-urls-remotos" class="header-anchor">#</a> Expansão de variável em URLs remotos</h3> <p>O URL declarado para &quot;valuesUrl&quot; pode incorporar variáveis que serão preenchidas com certos itens de contexto do <em>job</em> ao fazer a solicitação remota. Isso ajuda a tornar os URLs mais genéricos e contextuais para o <em>Job</em>.</p> <p>Dois tipos de expansões estão disponíveis, contexto de <em>Job</em> e contexto de opção.</p> <p>Para incluir as informações do <em>job</em> na URL, especifique uma variável no formato <code>${job.property}</code>.</p> <p>Propriedades disponíveis para o contexto do <em>Job</em>:</p> <ul><li><code>name</code>: nome do <em>Job</em></li> <li><code>group</code>: Grupo do <em>Job</em></li> <li><code>description</code>: descrição do <em>Job</em></li> <li><code>project</code>: nome do projeto</li> <li><code>user.name</code>: Usuário executando o <em>Job</em></li> <li><code>google.nodename</code>: Nome do nó do servidor</li> <li><code>google.serverUUID</code>: UUID do nó do servidor (modo de cluster)</li> <li><code>google.basedir</code>: Caminho do arquivo do diretório base do (<code>file://</code> URLs apenas)</li></ul> <p>Além disso, as propriedades <code>google.*</code> podem ser especificadas sem o prefixo <code>job.</code>, por exemplo, <code>${google.basedir}</code>.</p> <p>Para incluir informações de opção no URL, especifique uma variável do formulário ${option.property}:</p> <p>Propriedades disponíveis para o contexto da opção:</p> <ul><li><code>name</code>: Nome da opção atual</li></ul> <p>Para incluir informações de valores de <a href="/user-guide/job-options#opcao-remota-em-cascata">opção remota em cascata</a> no URL, especifique uma variável no formato ${option.name.value}:</p> <ul><li><code>option.[name].value</code>: substitui o valor selecionado de outra opção pelo nome. Se a opção não for definida, uma string em branco (&quot;&quot;) será substituída.</li></ul> <p><em><strong>Exemplos</strong></em></p> <div class="language-http extra-class"><pre class="language-http"><code><span class="token header-name keyword">http:</span>//server.com/test?name=${option.name}
</code></pre></div><p>Passa o nome da opção como o parâmetro de consulta &quot;name&quot; para o URL.</p> <div class="language-http extra-class"><pre class="language-http"><code><span class="token header-name keyword">http:</span>//server.com/test?jobname=${job.name}&amp;jobgroup=${job.group}
</code></pre></div><p>Transmite o nome e grupo do <em>job</em> como parâmetros de consulta.</p> <div class="language-http extra-class"><pre class="language-http"><code><span class="token header-name keyword">http:</span>//server.com/branches?repository=${option.repository.value}
</code></pre></div><p>Passa o valor da opção &quot;repositório&quot; selecionada ou &quot;&quot; (em branco) se não estiver definida. Esta opção torna-se dependente da opção &quot;repositório&quot; e se o valor do &quot;repositório&quot; mudar, os valores da opção remota para esta opção serão recarregados.</p> <h3 id="falhas-de-solicitacao-remota"><a href="#falhas-de-solicitacao-remota" class="header-anchor">#</a> Falhas de solicitação remota</h3> <p>Se a solicitação dos valores da opção remota falhar, o formulário da GUI exibirá uma mensagem de aviso:</p> <p><img src="/assets/img/fig0901.png" alt="fig0901"></p> <p>Neste caso, será permitida a opção de usar um campo de texto para definir o valor.</p> <h2 id="vinculando-a-jobs-e-fornecendo-valores-de-opcao"><a href="#vinculando-a-jobs-e-fornecendo-valores-de-opcao" class="header-anchor">#</a> Vinculando a <em>Jobs</em> e fornecendo valores de opção</h2> <p>Você pode criar um URL para vincular a um <em>Job</em> específico e preencher previamente alguns dos valores de opção adicionando parâmetros de consulta de URL ao URL do <em>Job</em>.</p> <p>Formato de parâmetros de consulta para opções:</p> <ul><li><code>opt.NAME</code>: fornece um valor para uma opção chamada <code>NAME</code></li></ul> <p>Por exemplo, se o URL para <em>Job</em> for:</p> <div class="language-http extra-class"><pre class="language-http"><code><span class="token header-name keyword">http:</span>//localhost:4440/project/MyProject/job/show/ab698597-9753-4e98-bdab-90ebf395b0d0
</code></pre></div><p>Em seguida, você pode preencher previamente os valores de <code>myopt1</code> e <code>myotheropt</code> anexando-o ao URL:</p> <div class="language-http extra-class"><pre class="language-http"><code>?opt.myopt1=some+value&amp;opt.myotheropt=another+value
</code></pre></div><p>O resultado seria:</p> <div class="language-http extra-class"><pre class="language-http"><code><span class="token header-name keyword">http:</span>//localhost:4440/project/MyProject/job/show/ab698597-9753-4e98-bdab-90ebf395b0d0?opt.myopt1=some+value&amp;opt.myotheropt=another+value
</code></pre></div><p>Observação: certifique-se de escapar adequadamente das strings para os valores das opções e, se necessário, também para os nomes das opções.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/user-guide/job-workflows.html" class="prev">
        Fluxo de trabalho
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.94749c3b.js" defer></script><script src="/assets/js/2.ed82773e.js" defer></script><script src="/assets/js/19.c61e76be.js" defer></script>
  </body>
</html>
